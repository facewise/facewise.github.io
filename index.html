<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+KR:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"facewise.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="facewiseLog">
<meta property="og:url" content="https://facewise.github.io/index.html">
<meta property="og:site_name" content="facewiseLog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Yonghyun Kim">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://facewise.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>facewiseLog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">facewiseLog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-github"><a href="https://github.com/facewise" rel="section" target="_blank"><i class="fab fa-github fa-fw"></i>Github</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yonghyun Kim</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/facewise" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;facewise" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:dydgus.k@gmail.com" title="E-Mail â†’ mailto:dydgus.k@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/12/04/spring-deprecated-okhttp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/04/spring-deprecated-okhttp/" class="post-title-link" itemprop="url">Spring í”„ë ˆì„ì›Œí¬ì˜ OkHttp ì˜ì¡´ì„± ì œê±°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-04 14:44:40" itemprop="dateCreated datePublished" datetime="2024-12-04T14:44:40+09:00">2024-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-05 11:53:43" itemprop="dateModified" datetime="2024-12-05T11:53:43+09:00">2024-12-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="OkHttpë€"><a href="#OkHttpë€" class="headerlink" title="OkHttpë€?"></a>OkHttpë€?</h1><p><a target="_blank" rel="noopener" href="https://github.com/square/okhttp">OkHttp</a>ëŠ” HTTP&#x2F;2 ì§€ì›, ë‚´ì¥ ìºì‹œ, ì‰¬ìš´ ì‚¬ìš©ë²• ë“±ìœ¼ë¡œ Android ê³„ì—´ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ê³  0ì— ê°€ê¹Œìš´ ì˜ì¡´ì„±ìœ¼ë¡œ Java ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§„ì˜ì—ì„œë„ ìì£¼ ì‚¬ìš©ë˜<strong>ì—ˆ</strong>ë˜ ì˜¤í”ˆì†ŒìŠ¤ HTTP í´ë¼ì´ì–¸íŠ¸ì…ë‹ˆë‹¤.</p>
<p>Square Inc.(í˜„ì¬ëŠ” BLOCK Inc.)ì˜ ì˜¤í”ˆì†ŒìŠ¤ íŒ€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ ì¤‘ì— í•˜ë‚˜ì…ë‹ˆë‹¤.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/square/okhttp/issues/3472">OkHttpì˜ íŠ¹ì§•</a></p>
<p>ì´ëŸ° íŠ¹ì§•ìœ¼ë¡œ ì¸í•´ Spring ì§„ì˜ì„ ë¹„ë¡¯í•´ì„œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ê³„ì˜ í•« ì•„ì´í…œì¸ <a target="_blank" rel="noopener" href="https://github.com/testcontainers/testcontainers-java">Testcontainers</a>ì—ì„œë„ ì‚¬ìš©í•˜ëŠ” ë“± ë²”ìš©ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ì…ë‹ˆë‹¤.</p>
<h2 id="Spring-Frameworkì—ì„œ-ì‚¬ìš©í•˜ëŠ”-í–ˆë˜-OkHttp"><a href="#Spring-Frameworkì—ì„œ-ì‚¬ìš©í•˜ëŠ”-í–ˆë˜-OkHttp" class="headerlink" title="Spring Frameworkì—ì„œ ì‚¬ìš©í•˜ëŠ”(í–ˆë˜) OkHttp"></a>Spring Frameworkì—ì„œ ì‚¬ìš©í•˜ëŠ”(í–ˆë˜) OkHttp</h2><p>Spring Frameworkì—ì„œ REST APIë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ ëª¨ë“ˆì¸ <code>RestTemplate</code>ì´ë‚˜ <code>RestClient</code>ëŠ” HTTP í†µì‹ ì„ ìœ„í•œ ì¶”ìƒí™” ëª¨ë“ˆë§Œ ì œê³µí•  ë¿ì´ê³  ì‹¤ì œ HTTP í†µì‹ ì€ HTTP Client ëª¨ë“ˆì— ì˜ì¡´í•©ë‹ˆë‹¤.</p>
<p><code>org.springframework.http.client</code> íŒ¨í‚¤ì§€ë¥¼ ë³´ë©´ ëŒ€ëµ ì–´ë–¤ HTTP Client ëª¨ë“ˆì´ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<img src="/2024/12/04/spring-deprecated-okhttp/image.png" class="">
<p><em>spring-web 6.0 ë²„ì „ì˜ org.springframework.http.client íŒ¨í‚¤ì§€</em></p>
<p>ìœ„ ì´ë¯¸ì§€ë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ Springì€ 6.0 ë²„ì „ ëŒ€ê¹Œì§€ëŠ” ì•„ë˜ HTTP í´ë¼ì´ì–¸íŠ¸ë“¤ì„ ê¸°ë³¸ ì œê³µí–ˆìŠµë‹ˆë‹¤.</p>
<ul>
<li><code>HttpComponentsClientHttpRequestFactory</code> : Apacheì˜ <code>HttpClient</code></li>
<li><code>OkHttp3ClientHttpRequestFactory</code> : OkHttp3ì˜ <code>OkHttpClient</code></li>
<li><code>SimpleClientHttpRequestFactory</code> : JDKì˜ <code>HttpURLConnection</code></li>
</ul>
<h1 id="ì‚¬ê±´ì˜-ë°œë‹¨"><a href="#ì‚¬ê±´ì˜-ë°œë‹¨" class="headerlink" title="ì‚¬ê±´ì˜ ë°œë‹¨"></a>ì‚¬ê±´ì˜ ë°œë‹¨</h1><p>ë¬¸ì œëŠ” ì´ë ‡ê²Œ ì˜ ì‚¬ìš©ë˜ë˜ OkHttpì—ì„œ 2019ë…„ í•˜ë‚˜ì˜ ë³€í™”ë¥¼ ì‹œë„í•˜ë©´ì„œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<img src="/2024/12/04/spring-deprecated-okhttp/image1.png" class="">
<p><em>OkHttpì˜ Kotlin ì „í™˜ ì„ ì–¸</em></p>
<p>ë°”ë¡œ <code>OkHttp 3</code>ì˜ ì½”ë“œë¥¼ ëª¨ë‘ Kotlinìœ¼ë¡œ ì „í™˜í•˜ê³ , Kotlin standard libraryë¥¼ ì¶”ê°€í•˜ì—¬ <code>OkHttp 4</code>ë¡œì˜ ë³€í™”ë¥¼ ì‹œë„í•œ ê²ƒì…ë‹ˆë‹¤.</p>
<blockquote>
<p>ì´ ë¬´ë µ Squareì—ì„œ Kotlinì— êµ‰ì¥íˆ ë§¤ë£Œë˜ì—ˆëŠ”ì§€ Javaë¡œ ëœ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë“¤ì„ ëŒ€ê±° Kotlinìœ¼ë¡œì˜ ì „í™˜ì„ ì‹œë„í•©ë‹ˆë‹¤.<br>Android ì§„ì˜ì— ë§ì€ ê¸°ì—¬ë¥¼ í•˜ë˜ Squareì´ì–´ì„œ ê·¸ëŸ°ì§€ Kotlinìœ¼ë¡œì˜ ì „í™˜ì€ ë¹¨ëìŠµë‹ˆë‹¤.</p>
</blockquote>
<p>ê·¸ëŸ¬ë©´ì„œ ìì‹ ë“¤ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë‘ë£¨ ì´ìš©ë˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆë˜ Squareì˜€ê¸° ë•Œë¬¸ì— ì´ì „ ë²„ì „ê³¼ 100% í˜¸í™˜ì„±ì„ ì œê³µí•˜ê² ë‹¤ê³  ì•½ì†í–ˆìŠµë‹ˆë‹¤.</p>
<h1 id="ë°˜ì‘"><a href="#ë°˜ì‘" class="headerlink" title="ë°˜ì‘"></a>ë°˜ì‘</h1><p>í•˜ì§€ë§Œ í•´ë‹¹ ì´ìŠˆì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ Zero-dependencyì— ê°€ê¹ë˜ Java ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ Kotlin ëŸ°íƒ€ì„ì˜ í° ì˜ì¡´ì„±ì´ ìƒê¸´ë‹¤ëŠ” ì ì€ Java ì˜¤í”ˆì†ŒìŠ¤ ì§„ì˜ì—ê² ë°˜ê°‘ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
<p><a target="_blank" rel="noopener" href="https://java.testcontainers.org/">Testcontainers for Java</a>ì˜ ì œì‘ìì´ë©´ì„œ <a target="_blank" rel="noopener" href="https://javachampions.org/members.html">Java Champion</a>ì´ê¸°ë„ í•œ <a target="_blank" rel="noopener" href="https://github.com/bsideup">Sergei Egorov</a>ëŠ” ì•„ì‰¬ì›€ì„ í‘œí˜„í–ˆìŠµë‹ˆë‹¤.</p>
<img src="/2024/12/04/spring-deprecated-okhttp/image2.png" class="">
<p><em>Sergei Egorovì˜ ì½”ë©˜íŠ¸</em></p>
<blockquote>
<p>ìµœê³ ì˜ JVM HTTP ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ì˜€ë˜ OkHttpê°€ ì´ì œ ë”ì´ìƒ ì¢‹ì€ ì„ íƒì´ ì•„ë‹ˆê²Œ ë˜ì–´ì„œ ì°¸ ìœ ê°ì…ë‹ˆë‹¤.<br>ì„¸ìƒì´ ì´ì „ì˜ ì‹¤ìˆ˜(Scala, Groovyë¡œ ë§Œë“  Java ë¼ì´ë¸ŒëŸ¬ë¦¬)ì—ì„œ êµí›ˆì„ ì–»ì§€ ëª»í•œ ê²ƒì´ ìŠ¬í”•ë‹ˆë‹¤.</p>
<p>OkHttpê°€ ì •ë§ ì¢‹ì•˜ë˜ ì ì€ ë‹¤ë¥¸ ì˜ì¡´ì„±ì´ ì—†ì—ˆê³  <a target="_blank" rel="noopener" href="https://maven.apache.org/plugins/maven-shade-plugin/">shade</a>í•˜ê¸° ì¢‹ì•˜ë˜ ì ì´ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë”ì´ìƒ ê·¸ë ‡ì§€ ì•Šê² ë„¤ìš”.<br>ì—¬ê¸°ì— ëŒ“ê¸€ì„ ë‚¨ê²¨ë†“ì„í…Œë‹ˆ, ë‹¤ìŒì— â€˜OkHttpê°€ Kotlin X.Y.Z ë²„ì „ê³¼ í˜¸í™˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤â€™ì™€ ê°™ì€ ì´ìŠˆë¥¼ ë§Œë‚˜ë©´ ì—¬ê¸°ì— ì™€ì„œ ğŸ‘ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
</blockquote>
<p>ë˜, ìì‹ ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ <strong>OkHttpë³´ë‹¤ëŠ” ëœ ìœ ëª…í•˜ê¸´ í•œë° ë§ì´ ì“°ì´ëŠ” Testcontainers</strong>ë¼ê³  ì†Œê°œí•˜ë©´ì„œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ë¥¼ ì œê±°í•˜ë ¤ê³  ë‹¤ë¥¸ ì–¸ì–´ê¹Œì§€ ì“°ëŠ” OkHttpë¥¼ ë”ì´ìƒ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ë©° ì•½ê°„ì˜ ì¡°ë¡± ì„ì¸ ì½”ë©˜íŠ¸ë„ ë§ë¶™ì˜€ìŠµë‹ˆë‹¤.</p>
<h2 id="Springì˜-ë°˜ì‘"><a href="#Springì˜-ë°˜ì‘" class="headerlink" title="Springì˜ ë°˜ì‘"></a>Springì˜ ë°˜ì‘</h2><p>ì„ ì–¸í•œëŒ€ë¡œ OkHttp 4ëŠ” 2019ë…„ì— ë¦´ë¦¬ì¦ˆë˜ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Springì€ OkHttp3ì´ ì•„ì£¼ ì˜ ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—¬ì„œ ê·¸ëŸ°ì§€ ë°”ë¡œ ê±·ì–´ë‚´ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
<p>Spring Bootì—ì„œë„ 2.6.X ë²„ì „ê¹Œì§€ëŠ” OkHttp 3ì˜ ë²„ì „ì„ ê´€ë¦¬í•´ì£¼ë‹¤ê°€ 2.7.0ë¶€í„°ëŠ” OkHttp 4ë¡œ ë²„ì „ì„ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ë“± ê³„ì†í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë“¯í•œ ëª¨ìŠµì´ì—ˆìŠµë‹ˆë‹¤.</p>
<p>í•˜ì§€ë§Œ ë”ì´ìƒ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë²„ì „ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ê³„ì†í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ì—ˆê³ , íŠ¹íˆ Webê³¼ ê´€ë ¨ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë”ìš±ë” ê·¸ë ‡ìŠµë‹ˆë‹¤. TLSì˜ ìµœì‹  ì‹¸ì´í¼ì— ëŒ€í•œ ì§€ì›ì´ ë˜ì§€ ì•ŠëŠ” ì  ë“±ì´ ì¹˜ëª…ì ì¸ ë³´ì•ˆ ì·¨ì•½ì ì´ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  Spring Bootê°€ ê³µì‹ ì§€ì›í•˜ëŠ” OkHttp 4 ë²„ì „ì„ ê³„ì† ì“°ê²Œ ë†”ë‘ìë‹ˆ ìì‹ ë“¤ì˜ í”„ë¡œì íŠ¸ì— ê±°ëŒ€í•œ Kotlin ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„±ì´ ìƒê¸°ëŠ” ê²ƒì´ íƒíƒì¹˜ ì•Šì•˜ì„ ê²ƒì´ë¼ê³  ì¶”ì¸¡í•©ë‹ˆë‹¤.</p>
<p>ê²°êµ­ Spring Webì€ <code>OkHttp3Client</code> ì‹œë¦¬ì¦ˆë¥¼ 6.1 ë²„ì „ì—ì„œ <code>Deprecated</code> ì²˜ë¦¬í•˜ê³  6.2 ë²„ì „ì—ì„œ ì‚­ì œí•˜ê¸°ë¡œ í•©ë‹ˆë‹¤.</p>
<img src="/2024/12/04/spring-deprecated-okhttp/image3.png" class="">
<p><em>Spring ì´ìŠˆ</em></p>
<blockquote>
<p>ì´ë¦„ì— ê±¸ë§ê²Œ OkHttp3ClientHttpRequestFactoryëŠ” OkHttp 3ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤. ì´í›„ 3ê³¼ í˜¸í™˜ì´ ê°€ëŠ¥í•œ OkHttp4ê°€ ì¶œì‹œë˜ì—ˆì§€ë§Œ, ì—¬ê¸°ì—ëŠ” Kotlin ëŸ°íƒ€ì„ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>OkHttp 5ëŠ” í˜„ì¬ ê°œë°œ ì¤‘ì´ë©° ì´ì „ ë²„ì „ê³¼ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. ì–´ë–¤ ì¢…ë¥˜ì˜ ë°± í¬íŒ… ì •ì±…ì´ ìˆëŠ”ì§€ ë¶ˆë¶„ëª…í•˜ê³  ì˜¤ë˜ëœ ì¢…ì†ì„±ì„ ìœ ì§€í•˜ë©´ ë³´ì•ˆ ìœ„í—˜ì´ ë°œìƒí•˜ë¯€ë¡œ OkHttp3ClientHttpRequestFactoryë¥¼ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.<br>ë˜í•œ í˜„ì¬ ë° í–¥í›„ OkHttp êµ¬í˜„ì—ëŠ” ëŸ°íƒ€ì„ì— Kotlinì´ í•„ìš”í•˜ë¯€ë¡œ Java ì‚¬ìš©ì—ëŠ” ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 6.1ì— ìƒˆë¡œìš´ <code>ClientHttpRequestFactory</code>ê°€ ë„ì…ë˜ì–´ <code>OkHttp3ClientHttpRequestFactory</code>ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì„ íƒì˜ í­ì´ ìƒê²¼ìŠµë‹ˆë‹¤.</p>
</blockquote>
<h3 id="ìƒˆë¡œìš´-HTTP-í´ë¼ì´ì–¸íŠ¸-ë„ì…"><a href="#ìƒˆë¡œìš´-HTTP-í´ë¼ì´ì–¸íŠ¸-ë„ì…" class="headerlink" title="ìƒˆë¡œìš´ HTTP í´ë¼ì´ì–¸íŠ¸ ë„ì…"></a>ìƒˆë¡œìš´ HTTP í´ë¼ì´ì–¸íŠ¸ ë„ì…</h3><p>Java HTTP í´ë¼ì´ì–¸íŠ¸ì˜ ì£¼ë¥˜ì˜€ë˜ OkHttpë¥¼ ì œê±°í•¨ê³¼ ë™ì‹œì— ë‹¤ë¥¸ ì¢‹ì€ HTTP í´ë¼ì´ì–¸íŠ¸ë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.</p>
<ul>
<li><code>JdkClientHttpRequestFactory</code> : JDK 11ë¶€í„° ì¶”ê°€ëœ <code>HttpClient</code></li>
<li><code>JettyClientHttpRequestFactory</code> : Jettyì˜ <code>HttpClient</code></li>
<li><code>ReactorClientHttpRequestFactory</code> : Nettyì˜ <code>HttpClient</code> (6.2 ë²„ì „)</li>
</ul>
<h2 id="Spring-Bootì˜-ëŒ€ì‘"><a href="#Spring-Bootì˜-ëŒ€ì‘" class="headerlink" title="Spring Bootì˜ ëŒ€ì‘"></a>Spring Bootì˜ ëŒ€ì‘</h2><p>Spring Frameworkì—ì„œ OkHttp3ì„ <code>Deprecated</code> ì²˜ë¦¬í•¨ì— ë”°ë¼ ê°€ì¥ ë°€ì ‘í•œ Spring Boot ì—­ì‹œ ê¸°ë¯¼í•˜ê²Œ ì›€ì§ì˜€ìŠµë‹ˆë‹¤.</p>
<img src="/2024/12/04/spring-deprecated-okhttp/image4.png" class="">
<p><em>Spring Boot ì´ìŠˆ</em></p>
<p>Spring Boot v3.4 ë¶€í„°ëŠ” spring-boot-dependenciesì˜ BOMì—ì„œ OkHttpì˜ ì˜ì¡´ì„± ë²„ì „ì„ ì œê±°í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, Spring Boot í”„ë¡œì íŠ¸ì—ì„œ OkHttp í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ì œ ë²„ì „ì„ ì§ì ‘ ëª…ì‹œí•´ì•¼ í•©ë‹ˆë‹¤.</p>
<h1 id="ì†Œê²¬"><a href="#ì†Œê²¬" class="headerlink" title="ì†Œê²¬"></a>ì†Œê²¬</h1><p>ì²˜ìŒì—ëŠ” Kotlinìœ¼ë¡œ ë§Œë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¬´ìŠ¨ ë¬¸ì œê°€ ìˆëŠ”ì§€ ì˜ì•„í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Kotlinìœ¼ë¡œ ì»´íŒŒì¼ëœ jar ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ Java í”„ë¡œì íŠ¸ì—ì„œ ì‹¤í–‰í•˜ë ¤ë©´ <code>kotlin-stdlib</code> ëª¨ë“ˆì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì´ ì¹˜ëª…ì ì¸ ë‹¨ì ì´ì—ˆìŠµë‹ˆë‹¤.</p>
<p><code>kotlin-stdlib</code>ì´ Java í”„ë¡œì íŠ¸ì— í¬í•¨ë˜ë©´ Kotlinì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ëŸ°íƒ€ì„ì´ ë“¤ì–´ì˜¤ê²Œ ë˜ì–´ì„œ Java íŒŒì¼ ì•ˆì—ì„œ Kotlinì—ë§Œ ìˆëŠ” í•¨ìˆ˜ë‚˜ coroutine ë“±ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.<br>ì˜ ì‚¬ìš©í•˜ë©´ ì¥ì ì´ ë  ìˆ˜ë„ ìˆëŠ” ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ì§€ë§Œ, Kotlinì„ ì‚¬ìš©í•  ê³„íšì´ ì—†ëŠ” í”„ë¡œì íŠ¸ì— HTTP í˜¸ì¶œë§Œì„ ìœ„í•´ 1MBê°€ ë„˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í¬í•¨ë˜ëŠ” ê²ƒì€ ë¶„ëª…íˆ ë‹¨ì ë„ ìˆìŠµë‹ˆë‹¤. ë§ì€ Java ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë“¤ì€ ì´ëŸ° ì´ìœ ë¡œ OkHttpë¥¼ ê±·ì–´ë‚´ëŠ” ì‘ì—…ë“¤ì„ ì§„í–‰í•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.</p>
<p>í•˜ì§€ë§Œ í’ˆì§ˆ ì¢‹ì€ HTTP APIë¥¼ ì œê³µí•˜ëŠ” <a target="_blank" rel="noopener" href="https://github.com/OpenFeign/feign">Feign</a>ì€ ì•„ì§ OkHttpì— ëŒ€í•œ ì§€ì›ì„ ì¤‘ë‹¨í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.<br>ìš”ì¦˜ <a target="_blank" rel="noopener" href="https://spring.io/projects/spring-cloud-openfeign">Spring Cloud OpenFeign</a>ì„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì íŠ¸ê°€ ë§ì•„ì¡ŒëŠ”ë°, Feignì˜ HTTP í´ë¼ì´ì–¸íŠ¸ë¥¼ OkHttpë¡œ ì„ íƒí•œë‹¤ë©´ ìì‹ ì˜ Java í”„ë¡œì íŠ¸ì— ë¶ˆí•„ìš”í•œ Kotlin ëŸ°íƒ€ì„ì´ í¬í•¨ëœë‹¤ëŠ” ì‚¬ì‹¤ì„ ì¸ì§€í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/07/29/spring-transaction-management/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/29/spring-transaction-management/" class="post-title-link" itemprop="url">Springì˜ Transaction ê´€ë¦¬</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-07-29 16:44:41" itemprop="dateCreated datePublished" datetime="2024-07-29T16:44:41+09:00">2024-07-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-07-30 09:34:10" itemprop="dateModified" datetime="2024-07-30T09:34:10+09:00">2024-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ìŠ¤í”„ë§ ë¶€íŠ¸ë¡œ í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ <code>@Transactional</code>ì´ ì£¼ëŠ” í¸ë¦¬í•¨ì„ ë‹¹ì—°í•˜ë‹¤ê³ ë§Œ ë°›ì•„ë“¤ì˜€ë‹¤.<br>ê·¸ëŸ¬ë‹¤ ë³´ë‹ˆ ì–´ë–¤ ì›ë¦¬ë¡œ <code>@Transactional</code> ë©”ì†Œë“œê°€ íŠ¸ëœì­ì…˜ìœ¼ë¡œì„œ ì‘ë™í•˜ëŠ”ì§€ ëª¨ë¥¸ ì±„ë¡œ ì‚¬ìš©í•´ì™”ë‹¤.</p>
<p>ë‚˜ì™€ ê°™ì€ ê³ ë¯¼ì„ í•œ ì‚¬ëŒë“¤ì—ê²Œ ìŠ¤í”„ë§ì´ íŠ¸ëœì­ì…˜ì„ ì»¨íŠ¸ë¡¤í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê³µìœ í•˜ë ¤ê³  í•œë‹¤. </p>
<h1 id="ê°œìš”"><a href="#ê°œìš”" class="headerlink" title="ê°œìš”"></a>ê°œìš”</h1><p>ìŠ¤í”„ë§ì´ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ ìŠ¤í”„ë§ì´ ì—†ëŠ” ìƒíƒœì—ì„œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ê¸°ë¶€í„° ì‹œì‘í•´ì„œ<br>ìŠ¤í”„ë§ì˜ ì„¤ê³„ ì‚¬ìƒì„ í•œ ë‹¨ê³„ì”© ì ìš©í•´ê°€ë©´ì„œ ì°¨ê·¼ì°¨ê·¼ ì´í•´í•´ë³´ë ¤ê³  í•œë‹¤.</p>
<p>ì¦‰, JDBC ë ˆë²¨ì—ì„œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ë¶€í„° ì‹œì‘í•˜ë©´ì„œ ìŠ¤í”„ë§ì´ íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ì„¤ê³„í•˜ê¸° ìœ„í•´ ì–´ë–¤ ìƒê°ë“¤ì„<br>ì ìš©í•˜ëŠ”ì§€ í•˜ë‚˜í•˜ë‚˜ ì•Œì•„ë³´ëŠ” ê²ƒì´ ê¸°ì´ˆë¥¼ ë‹¤ì§€ê¸° ì¢‹ë‹¤ê³  ìƒê°í•´ì„œì´ë‹¤.</p>
<h1 id="JDBCì˜-íŠ¸ëœì­ì…˜-ê´€ë¦¬"><a href="#JDBCì˜-íŠ¸ëœì­ì…˜-ê´€ë¦¬" class="headerlink" title="JDBCì˜ íŠ¸ëœì­ì…˜ ê´€ë¦¬"></a>JDBCì˜ íŠ¸ëœì­ì…˜ ê´€ë¦¬</h1><p>íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì´ JDBCì´ë“ , ìŠ¤í”„ë§ì´ë“ , Hibernateì´ë“  ê´€ê³„ì—†ì´ DB íŠ¸ëœì­ì…˜ì€ ì•„ë˜ì™€ ê°™ì€ ê³¼ì •ì„ ê±°ì¹œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doTransaction</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">    Connection connection;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection= dataSource.getConnection();</span><br><span class="line">        connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">        connection.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        connection.rollback();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Javaì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ëŠ” ë°©ë²•ì€ ì´ ë°©ë²• ë°–ì—ëŠ” ì—†ë‹¤.<br>ì¦‰, ìŠ¤í”„ë§ë„ ìµœì¢…ì ìœ¼ë¡  ì´ JDBC APIë¥¼ í˜¸ì¶œí•¨ìœ¼ë¡œì¨ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ê³  ìˆë‹¤.<br>ì‚¬ì‹¤ ìŠ¤í”„ë§ì´ <code>@Transactional</code> ë©”ì†Œë“œì— ëŒ€í•´ì„œ í•´ì£¼ëŠ” ì—­í• ì€ ìœ„ ë™ì‘ì„ í•´ì£¼ëŠ” ê²ƒ ë¿ì´ë‹¤.</p>
<h2 id="JDBC-íŠ¸ëœì­ì…˜-ì „íŒŒ-ì˜µì…˜ê³¼-ê²©ë¦¬-ìˆ˜ì¤€"><a href="#JDBC-íŠ¸ëœì­ì…˜-ì „íŒŒ-ì˜µì…˜ê³¼-ê²©ë¦¬-ìˆ˜ì¤€" class="headerlink" title="JDBC íŠ¸ëœì­ì…˜ ì „íŒŒ ì˜µì…˜ê³¼ ê²©ë¦¬ ìˆ˜ì¤€"></a>JDBC íŠ¸ëœì­ì…˜ ì „íŒŒ ì˜µì…˜ê³¼ ê²©ë¦¬ ìˆ˜ì¤€</h2><p>ì—¬ê¸°ì„œ íŠ¸ëœì­ì…˜ì˜ ì „íŒŒ(propagation) ë°©ì‹ê³¼ ê²©ë¦¬(isolation) ìˆ˜ì¤€ì„ ë‹¤ë¥´ê²Œ í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.Savepoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doTransaction</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">    Connection connection;</span><br><span class="line">    Savepoint savepoint;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = dataSource.getConnection();</span><br><span class="line">        <span class="comment">// ê²©ë¦¬ ìˆ˜ì¤€ ì„¤ì •</span></span><br><span class="line">        connection.setTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED);</span><br><span class="line">        <span class="comment">// ì „íŒŒ ì˜µì…˜ ì„¤ì •</span></span><br><span class="line">        savepoint = connection.setSavepoint();</span><br><span class="line">        connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">        connection.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        connection.rollback(savepoint);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ìŠ¤í”„ë§ì˜-íŠ¸ëœì­ì…˜-ê´€ë¦¬"><a href="#ìŠ¤í”„ë§ì˜-íŠ¸ëœì­ì…˜-ê´€ë¦¬" class="headerlink" title="ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ê´€ë¦¬"></a>ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ê´€ë¦¬</h1><p>ìŠ¤í”„ë§ì—ì„œëŠ” ìœ„ ì‘ì—…ì„ ë‹¨ìˆœí™”í•˜ê¸° ìœ„í•´ì„œ <code>PlatformTransactionManager</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì—ˆê³  ì´ ì¸í„°í˜ì´ìŠ¤ëŠ”<br>JDBCê°€ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ë˜ ë°©ë²•ì„ ì¶”ìƒí™”í–ˆë‹¤.</p>
<h2 id="í”„ë¡œê·¸ë˜ë°ì -íŠ¸ëœì­ì…˜-ê´€ë¦¬"><a href="#í”„ë¡œê·¸ë˜ë°ì -íŠ¸ëœì­ì…˜-ê´€ë¦¬" class="headerlink" title="í”„ë¡œê·¸ë˜ë°ì  íŠ¸ëœì­ì…˜ ê´€ë¦¬"></a>í”„ë¡œê·¸ë˜ë°ì  íŠ¸ëœì­ì…˜ ê´€ë¦¬</h2><p><code>PlatformTransactionManager</code>ë¥¼ í†µí•´ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">doTransaction</span><span class="params">(PlatformTransactionManager platformTransactionManager)</span> &#123;</span><br><span class="line">    <span class="comment">// íŠ¸ëœì­ì…˜ ì˜µì…˜ ì„¤ì •</span></span><br><span class="line">    TransactionDefinition transactionDefinition;</span><br><span class="line">    transactionDefinition.setPropagationBehavior(PROPAGATION_REQUIRES_NEW);</span><br><span class="line">    transactionDefinition.setIsolationLevel(ISOLATION_READ_COMMITTED);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Connection ì–»ì–´ì˜¤ê¸°</span></span><br><span class="line">    <span class="type">TransactionStatus</span> <span class="variable">transactionStatus</span> <span class="operator">=</span> platformTransactionManager.getTranscation(transactionDefinition);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        platformTransactionManager.rollback();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">    platformTransactionManager.commit();</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìŠ¤í”„ë§ì´ êµ¬ì²´ì ìœ¼ë¡œ ì œì‹œí•œ ì‚¬ìš©ë²•ì€ <code>TransactionTemplate</code>ì— ì˜ êµ¬í˜„ë˜ì–´ ìˆë‹¤.</p>
<p><em>TransactionTemplate.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">execute</span><span class="params">(TransactionCallback&lt;T&gt; action)</span> <span class="keyword">throws</span> TransactionException &#123;</span><br><span class="line">    Assert.state(<span class="built_in">this</span>.transactionManager != <span class="literal">null</span>, <span class="string">&quot;No PlatformTransactionManager set&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.transactionManager <span class="keyword">instanceof</span> CallbackPreferringPlatformTransactionManager cpptm) &#123;</span><br><span class="line">        <span class="keyword">return</span> cpptm.execute(<span class="built_in">this</span>, action);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">TransactionStatus</span> <span class="variable">status</span> <span class="operator">=</span> <span class="built_in">this</span>.transactionManager.getTransaction(<span class="built_in">this</span>);</span><br><span class="line">        T result;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            result = action.doInTransaction(status);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error ex) &#123;</span><br><span class="line">            <span class="comment">// Transactional code threw application exception -&gt; rollback</span></span><br><span class="line">            rollbackOnException(status, ex);</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">            <span class="comment">// Transactional code threw unexpected exception -&gt; rollback</span></span><br><span class="line">            rollbackOnException(status, ex);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UndeclaredThrowableException</span>(ex, <span class="string">&quot;TransactionCallback threw undeclared checked exception&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.transactionManager.commit(status);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì´ëŸ° ì¶”ìƒí™” ë•ë¶„ì— ìŠ¤í”„ë§ ì‚¬ìš©ìëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°„í¸í•´ì¡Œë‹¤.</p>
<ul>
<li>ë”ì´ìƒ JDBCì˜ <code>Connection</code>ì„ <code>open</code>, <code>commit</code>, <code>close</code>ë“±ì„ í˜¸ì¶œí•  í•„ìš”ê°€ ì—†ì–´ì§</li>
<li>ì˜ˆì™¸ ë°œìƒ ì‹œ <code>RuntimeException</code>ìœ¼ë¡œ ë³€ê²½í•˜ê¸° ë•Œë¬¸ì— <code>try-catch</code> êµ¬ë¬¸ì„ ì‘ì„±í•  í•„ìš”ê°€ ì—†ì–´ì§</li>
<li>íŠ¸ëœì­ì…˜ ì•ˆì—ì„œì˜ ë™ì‘ë§Œ ê¸°ìˆ í•˜ë©´ ë¨</li>
</ul>
<p>í•˜ì§€ë§Œ ì´ë ‡ê²Œ ì½”ë“œë¥¼ í†µí•œ íŠ¸ëœì­ì…˜ ì‹¤í–‰ì€ ìŠ¤í”„ë§ì´ ê·¼ë³¸ì ìœ¼ë¡œ ì¶”êµ¬í•˜ëŠ” ë°©í–¥ì€ ì•„ë‹ˆì—ˆë‹¤.</p>
<h2 id="ì„ ì–¸ì -íŠ¸ëœì­ì…˜-ê´€ë¦¬"><a href="#ì„ ì–¸ì -íŠ¸ëœì­ì…˜-ê´€ë¦¬" class="headerlink" title="ì„ ì–¸ì  íŠ¸ëœì­ì…˜ ê´€ë¦¬"></a>ì„ ì–¸ì  íŠ¸ëœì­ì…˜ ê´€ë¦¬</h2><p>ìŠ¤í”„ë§ì—ì„œ XML ë°©ì‹ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ê¸°ë³¸ì´ì—ˆì„ ë•Œì—ëŠ” íŠ¸ëœì­ì…˜ ë˜í•œ XMLë¡œ ì„¤ì •í•´ì•¼ í–ˆë‹¤.<br>XMLì„ í†µí•œ ì„¤ì •ë²•ì€ ì´ë¯¸ ë ˆê±°ì‹œ(Legacy)ê°€ ë˜ì—ˆìœ¼ë¯€ë¡œ ìì„¸íˆ ì•Œì•„ë³´ì§€ëŠ” ì•Šê² ì§€ë§Œ ì´ëŸ° ë°©ì‹ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œì•„ë‘ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;transactionAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- getìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë©”ì†Œë“œëŠ” readOnlyë¥¼ trueë¡œ ì„¤ì • --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ìŠ¤í”„ë§ AOPë¥¼ í†µí•´ Adviceë¥¼ ìœ„ì™€ ê°™ì´ êµ¬ì„±í•˜ê³  ì•„ë˜ì™€ ê°™ì´ íŠ¹ì • ë¹ˆì— ì ìš©í•  ìˆ˜ ìˆì—ˆë‹¤.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;userServicePointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* x.y.service.UserService.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;transactionAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;userServicePointcut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;x.y.service.UserService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ê·¸ë¦¬ê³  <code>UserService</code> í´ë˜ìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ì„ ê²ƒì´ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AOPë¥¼ ì´ìš©í•œ ì„ ì–¸ì  íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ í”„ë¡œê·¸ë˜ë°ì  íŠ¸ëœì­ì…˜ë³´ë‹¤ ì½”ë“œëŠ” í›¨ì”¬ ë” ê°„ë‹¨í•´ì¡Œë‹¤.<br>í•˜ì§€ë§Œ ì´ë¥¼ ìœ„í•´ XML íŒŒì¼ì„ ì‘ì„±í•˜ê³  ì„¤ì •í•´ì•¼ í–ˆìœ¼ë©° XML íŒŒì¼ì€ ë‚´ìš©ì´ ë„ˆë¬´ ì¥í™©í–ˆë‹¤.</p>
<h2 id="Transactional"><a href="#Transactional" class="headerlink" title="@Transactional"></a>@Transactional</h2><p>ì´ì œ ìµœê·¼ ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë°©ë²•ì¸ <code>@Transactional</code> ì‚¬ìš©ì„ ë³´ì.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì´ì œ ë”ì´ìƒ XML ì„¤ì •ë„ í•„ìš” ì—†ê³  <code>try-catch</code>, <code>commit</code>, <code>rollback</code> ê°™ì€ ì½”ë“œë„ í•„ìš”í•˜ì§€ ì•Šë‹¤.</p>
<p>í•˜ì§€ë§Œ ë‹¤ìŒ ë‘ ê°€ì§€ ì„¤ì •ì„ í•´ì•¼í•œë‹¤.</p>
<ul>
<li>Spring Configuration ì¤‘ì— <code>@EnableTransactionManagement</code>ê°€ ì ìš©ëœ Configurationì´ ìˆì–´ì•¼ í•œë‹¤.<br>(Spring Bootì—ì„œëŠ” ìë™ìœ¼ë¡œ ì„¤ì •í•´ì¤€ë‹¤.)</li>
<li><code>PlatformTransactionManager</code> ë¹ˆì´ ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.</li>
</ul>
<p>ì´ ë‘ ì„¤ì •ë§Œ ë§ˆì¹˜ë©´ ìŠ¤í”„ë§ì€ ìë™ìœ¼ë¡œ <code>@Transactional</code>ì´ ìˆëŠ” <em><strong>public</strong></em> ë©”ì†Œë“œì— ëŒ€í•´ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•  ê²ƒì´ë‹¤.</p>
<p>ì¦‰, ìŠ¤í”„ë§ì€ ìœ„ì˜ ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ <em>ë²ˆì—­í•´</em> ì¤„ ê²ƒì´ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        Connection connection;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = dataSource.getConnection();</span><br><span class="line">            connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">            <span class="comment">// SQL ì‹¤í–‰</span></span><br><span class="line">            <span class="keyword">return</span> id;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            connection.rollback();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì–´ë–»ê²Œ ì´ê²Œ ê°€ëŠ¥í•œì§€ ì´ì œ íŒŒí—¤ì³ë³´ì.</p>
<h1 id="CGLIB-JDK-í”„ë¡ì‹œ"><a href="#CGLIB-JDK-í”„ë¡ì‹œ" class="headerlink" title="CGLIB, JDK í”„ë¡ì‹œ"></a>CGLIB, JDK í”„ë¡ì‹œ</h1><p>ë‚´ê°€ ì‘ì„±í•œ <code>UserService</code>ì˜ <code>save()</code> ë©”ì†Œë“œëŠ” SQLì„ ì‹¤í–‰í•˜ê³  <code>id</code>ë¥¼ ë¦¬í„´í•  ë¿ì¸ë° ìŠ¤í”„ë§ì´ ë‚´ê°€ ì§  ì½”ë“œë¥¼ ë³€ê²½í•  ë°©ë²•ì€ ì—†ë‹¤.</p>
<p>ê·¸ ê³¼ì •ì—ì„œ ìŠ¤í”„ë§ì€ ê¼¼ìˆ˜ë¥¼ ë¶€ë¦°ë‹¤. ë‚´ê°€ ë§Œë“  <code>UserService</code>ë§Œ ê°ì²´ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆë¼ <strong>í”„ë¡ì‹œ ê°ì²´ë„ ê°™ì´ ìƒì„±í•œë‹¤</strong>.</p>
<p>ê·¸ë¦¬ê³  ìŠ¤í”„ë§ì˜ IoC ì»¨í…Œì´ë„ˆëŠ” <code>UserService</code>ë¹ˆì„ í•„ìš”ë¡œ í•˜ëŠ” ë‹¤ë¥¸ ê³³ì— ì˜ì¡´ì„±ìœ¼ë¡œ ì£¼ì…í•´ì¤„ ë•Œ <strong>í”„ë¡ì‹œë¥¼ ëŒ€ì‹  ì£¼ì…í•œë‹¤.</strong></p>
<p>CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” <code>UserService</code>ë¥¼ ìƒì†í•œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. (JDK í”„ë¡ì‹œëŠ” ë°©ì‹ì´ ì•½ê°„ ë‹¤ë¥´ê¸´ ì—¬ê¸°ì„œ ë‹¤ë£¨ì§„ ì•Šê² ë‹¤.)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">post</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.save(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì¦‰, <code>UserController</code>ì—ì„œ <code>UserService</code>ì˜ <code>save()</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´, ì§„ì§œ <code>UserService</code>ê°€ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼<br>ê°€ì§œë¡œ ë§Œë“  í”„ë¡ì‹œì˜ <code>save()</code>ê°€ í˜¸ì¶œë˜ëŠ” ê²ƒì´ë‹¤.</p>
<h1 id="PlatformTransactionManager-ì—­í• "><a href="#PlatformTransactionManager-ì—­í• " class="headerlink" title="PlatformTransactionManager ì—­í• "></a><code>PlatformTransactionManager</code> ì—­í• </h1><p>ê·¸ë ‡ë‹¤ë©´ ì´ ê³¼ì •ì—ì„œ <code>PlatformTransactionManager</code>ëŠ” ì™œ í•„ìš”í•œ ê±¸ê¹Œ?</p>
<p>ìƒì„±ëœ í”„ë¡ì‹œëŠ” ì§ì ‘ íŠ¸ëœì­ì…˜ì„ ì»¨íŠ¸ë¡¤í•˜ì§€ ì•ŠëŠ”ë‹¤. ëŒ€ì‹  <code>PlatformTransactionManager</code>ì—ê²Œ ì´ëŸ° ì„ë¬´ë¥¼ ë§¡ê²¨ë²„ë¦°ë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ <code>DataSourceTransactionManager</code>ì˜ <code>doBegin()</code> ë©”ì†Œë“œì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ë³´ë©´ ìš°ë¦¬ê°€ ì´ˆë°˜ë¶€ì— ì•Œì•„ë³¸ ë°©ë²•ê³¼<br>ë™ì¼í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<p><em>DataSourceTransactionManager.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceTransactionManager</span> <span class="keyword">implements</span> <span class="title class_">PlatformTransactionManager</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doBegin</span><span class="params">(Object transaction, TransactionDefinition definition)</span> &#123;</span><br><span class="line">        Connection con;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            con = <span class="built_in">this</span>.obtainDataSource().getConnection();</span><br><span class="line">            <span class="comment">// ..</span></span><br><span class="line">            con.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">            <span class="comment">// JDBC íŠ¸ëœì­ì…˜ ì‹œì‘ ë°©ë²•ê³¼ ë™ì¼</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// ìƒëµ</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìŠ¤í”„ë§ì´ êµ¬í˜„í•œ <code>DataSourceTransactionManager</code>ëŠ” ìš°ë¦¬ê°€ ì²˜ìŒì— ì•Œì•„ë³¸ JDBCë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ëŠ” ë°©ë²•ê³¼ ì™„ì „íˆ ë˜‘ê°™ë‹¤.</p>
<h1 id="ìš”ì•½"><a href="#ìš”ì•½" class="headerlink" title="ìš”ì•½"></a>ìš”ì•½</h1><p>íŠ¸ëœì­ì…˜ì„ í¸ë¦¬í•˜ê²Œ í•  ìˆ˜ ìˆê²Œ ìŠ¤í”„ë§ì´ ìš°ë¦¬ì—ê²Œ í•´ì¤€ ê²ƒì€ ë°˜ë³µëœ ì½”ë“œë¥¼ ì¶”ìƒí™”í•´ì¤€ ê²ƒì´ë‹¤.</p>
<ol>
<li>ìŠ¤í”„ë§ì€ <code>@Transactional</code>ì´ ë¶™ì€ ë©”ì†Œë“œ(ë˜ëŠ í´ë˜ìŠ¤)ë¥¼ ì°¾ì•„ì„œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.</li>
<li>í”„ë¡ì‹œëŠ” <code>TransactionManager</code>ë¥¼ ìì²´ì ìœ¼ë¡œ ê°€ì§€ê³  ìˆê³  íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ì—¬ê¸°ì— ë§¡ê²¨ë²„ë¦°ë‹¤.</li>
<li><code>TransactionManager</code>ëŠ” JDBCë¡œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ê³¼ ë™ì¼í•˜ê²Œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•œë‹¤.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/04/12/spring-method-security/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/12/spring-method-security/" class="post-title-link" itemprop="url">[Spring Security] ë©”ì†Œë“œ ì¸ê°€ (Method Security)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-04-12 10:59:11 / Modified: 16:02:34" itemprop="dateCreated datePublished" datetime="2024-04-12T10:59:11+09:00">2024-04-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Spring Security 6.2.3 ë²„ì „ì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<h1 id="Method-Securityë€"><a href="#Method-Securityë€" class="headerlink" title="Method Securityë€?"></a>Method Securityë€?</h1><p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ ì²˜ìŒ ì ‘í•  ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë£¨ëŠ” ì¸ê°€ëŠ” ìš”ì²­ URIì— ëŒ€í•œ ì¸ê°€ì¸ ê²ƒ ê°™ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">SecurityFilterChain <span class="title function_">web</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	http</span><br><span class="line">		.authorizeHttpRequests((authorize) -&gt; authorize</span><br><span class="line">			.requestMatchers(<span class="string">&quot;/user/**&quot;</span>).hasAuthority(<span class="string">&quot;USER&quot;</span>)</span><br><span class="line">            .requestMatchers(<span class="string">&quot;/admin/**&quot;</span>).hasAuthority(<span class="string">&quot;ADMIN&quot;</span>)</span><br><span class="line">			.anyRequest().authenticated()</span><br><span class="line">		)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> http.build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ ì½”ë“œì²˜ëŸ¼ ë¹ˆì„ ë§Œë“¤ê³  <code>requestMatchers()</code>ë¥¼ ì‚¬ìš©í•´ì„œ API ì—”ë“œí¬ì¸íŠ¸ì— ì¸ê°€ë¥¼ ì ìš©í•˜ëŠ” ë°©ì‹ì„ ì²˜ìŒ ì ‘í•˜ê²Œ ëœë‹¤.</p>
<p>ê·œëª¨ê°€ ì‘ì€ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ì—ì„œëŠ” í•´ë‹¹ ë°©ì‹ìœ¼ë¡œ ì¸ê°€ë¥¼ ì²˜ë¦¬í•´ë„ ì¶©ë¶„íˆ ì»¤ë²„ ê°€ëŠ¥í•˜ë‹¤.</p>
<p>ê·¸ë¦¬ê³  ë„ë©”ì¸ ê¶Œí•œì´ ì¤‘ìš”í•˜ì§€ ì•Šìœ¼ë©´ í¬ê²Œ ë¬¸ì œê°€ ì—†ë‹¤.</p>
<p>í•˜ì§€ë§Œ ë„ë©”ì¸ì— ëŒ€í•œ ê¶Œí•œì„ ì—„ê²©í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ì´ê±°ë‚˜ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œëŠ”</p>
<p>API ì—”ë“œí¬ì¸íŠ¸ì˜ ìˆ˜ë„ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ì—”ë“œí¬ì¸íŠ¸ë§Œ ê²€ì‚¬í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œëŠ” ì´˜ì´˜í•˜ê²Œ ê¶Œí•œì„ ê²€ì‚¬í•˜ê¸° í˜ë“¤ ìˆ˜ ìˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— <strong>Method Security</strong>ë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤:</p>
<ul>
<li>ê¶Œí•œ ì²´í¬ ë¡œì§ì´ ë³µì¡í•´ì„œ ì„¸ë¶„í™”ë˜ì–´ì•¼ í•  ê²½ìš°</li>
<li>ì„œë¹„ìŠ¤ ë ˆì´ì–´ì—ì„œë„ ê¶Œí•œì„ ì²´í¬í•´ì•¼ í•  ê²½ìš°</li>
<li>ì• ë„ˆí…Œì´ì…˜ ë°©ì‹ì˜ ì½”ë“œ ìŠ¤íƒ€ì¼ê³¼ AOPë¥¼ ì§€í–¥í•  ê²½ìš°</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>API ë ˆë²¨</th>
<th>ë©”ì†Œë“œ ë ˆë²¨</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ê¶Œí•œ ìˆ˜ì¤€</strong></td>
<td>ì´˜ì´˜í•˜ì§€ ì•ŠìŒ</td>
<td>ì´˜ì´˜í•¨</td>
</tr>
<tr>
<td><strong>ì„¤ì • ë°©ë²•</strong></td>
<td>Config ë¹ˆ</td>
<td>ë©”ì†Œë“œì— ì„ ì–¸</td>
</tr>
<tr>
<td><strong>ì„¤ì • ìŠ¤íƒ€ì¼</strong></td>
<td>DSL</td>
<td>ì• ë„ˆí…Œì´ì…˜</td>
</tr>
<tr>
<td><strong>ì¸ê°€ í‘œí˜„ì‹</strong></td>
<td>Ant, ì •ê·œì‹ ë“±</td>
<td>SpEL</td>
</tr>
</tbody></table>
<p><strong>ë©”ì†Œë“œ ì¸ê°€</strong>ëŠ” <strong>Spring AOP</strong> ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•œë‹¤.</p>
<p>ì¦‰, ë©”ì†Œë“œ í˜¸ì¶œì˜ <strong>before</strong>ì™€ <strong>after</strong>ì— ê¶Œí•œì„ ì²´í¬í•˜ê³  ì‹¶ì€ ê²½ìš° ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>
<br>

<h1 id="ë©”ì†Œë“œ-ì‹œíë¦¬í‹°-í™œì„±í™”"><a href="#ë©”ì†Œë“œ-ì‹œíë¦¬í‹°-í™œì„±í™”" class="headerlink" title="ë©”ì†Œë“œ ì‹œíë¦¬í‹° í™œì„±í™”"></a>ë©”ì†Œë“œ ì‹œíë¦¬í‹° í™œì„±í™”</h1><p>ë©”ì†Œë“œ ë ˆë²¨ ì¸ê°€ë¥¼ í™œì„±í™”í•˜ê¸° ìœ„í•´ì„œëŠ” <code>@Configuration</code>ì´ ì„¤ì •ëœ ë¹ˆì— <code>@EnableMethodSecurity</code> ë¥¼ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableMethodSecurity</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityConfig</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<br>

<h1 id="ë©”ì†Œë“œ-ì¸ê°€ì˜-íë¦„"><a href="#ë©”ì†Œë“œ-ì¸ê°€ì˜-íë¦„" class="headerlink" title="ë©”ì†Œë“œ ì¸ê°€ì˜ íë¦„"></a>ë©”ì†Œë“œ ì¸ê°€ì˜ íë¦„</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;hasAuthority(&#x27;permission:read&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@PostAuthorize(&quot;returnObject.owner == authentication.name&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Customer <span class="title function_">readCustomer</span><span class="params">(String id)</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ì™€ ê°™ì€ ì„œë¹„ìŠ¤ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì.</p>
<p>ê·¸ëŸ¬ë©´ <code>readCustomer()</code>ë¼ëŠ” ë©”ì†Œë“œì— ëŒ€í•œ ì¸ê°€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íë¦„ìœ¼ë¡œ ì ìš©ëœë‹¤.</p>
<ol>
<li><strong>Spring AOP</strong>ëŠ” <code>readCustomer()</code>ì˜ í”„ë¡ì‹œ ë©”ì†Œë“œë¥¼ ë§Œë“¤ì–´ì„œ ê°ì‹¼ë‹¤.</li>
<li><code>readCustomer()</code>ì˜ í”„ë¡ì‹œ ë©”ì†Œë“œì—ì„œëŠ” <code>AuthorizationManagerBeforeMethodInterceptor</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
<li><strong>ì¸í„°ì…‰í„°</strong>ëŠ” <code>PreAuthroizeAuthorizationManager#check()</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
<li><strong>AuthorizationManager</strong>ëŠ” <code>@PreAuthorize</code>ì•ˆì˜ SpEL í‘œí˜„ì‹ê³¼ <code>Authentication</code>ì„ ë‹´ì€ ì»¨í…ìŠ¤íŠ¸ë¥¼ <strong>ì¸í„°ì…‰í„°</strong>ì— ì œê³µí•œë‹¤.</li>
<li><strong>ì¸í„°ì…‰í„°</strong>ëŠ” ì»¨í…ìŠ¤íŠ¸ì— ë‹´ê¸´ <code>Authentication</code>ê³¼ í‘œí˜„ì‹ì„ ë³´ê³  ê¶Œí•œ ë¶€ì—¬ê°€ ê°€ëŠ¥í•œì§€ ì²´í¬í•œë‹¤.</li>
<li>ê¶Œí•œ ì²´í¬ì— í†µê³¼í•˜ë©´ AOPëŠ” <code>readCustomer()</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
<li>ì²´í¬ì— í†µê³¼í•˜ì§€ ëª»í•œë‹¤ë©´ <code>AccessDeniedException</code>ë¥¼ ë˜ì§„ë‹¤.</li>
<li><code>readCustomer()</code>ì˜ í˜¸ì¶œì´ ëë‚˜ê³  ë¦¬í„´ë˜ë©´ í”„ë¡ì‹œê°€ <code>AuthorizationManagerAfterMethodInterceptor</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
<li><strong>ì¸í„°ì…‰í„°</strong>ëŠ” <code>PostAuthroizeAuthorizationManager#check()</code>ë¥¼ í˜¸ì¶œí•œë‹¤.</li>
<li><code>@PostAuthorize</code>ì•ˆì˜ í‘œí˜„ì‹ì´ í†µê³¼í•˜ë©´ ì •ìƒì ì¸ íë¦„ìœ¼ë¡œ ì¢…ë£Œëœë‹¤.</li>
<li>ë§ˆì°¬ê°€ì§€ë¡œ í†µê³¼í•˜ì§€ ëª»í•˜ë©´ <code>AccessDeniedException</code>ì„ ë˜ì§„ë‹¤.</li>
</ol>
<br>

<h1 id="ì• ë„ˆí…Œì´ì…˜"><a href="#ì• ë„ˆí…Œì´ì…˜" class="headerlink" title="ì• ë„ˆí…Œì´ì…˜"></a>ì• ë„ˆí…Œì´ì…˜</h1><p>ë©”ì†Œë“œ ì¸ê°€ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì§€ë§Œ ì• ë„ˆí…Œì´ì…˜ ë°©ì‹ì´ ì œì¼ ê¶Œì¥ëœë‹¤.</p>
<p>ì• ë„ˆí…Œì´ì…˜ì—ì„œ ê¶Œí•œì„ ê²€ì¦í•˜ëŠ” ë¡œì§ì„ ì‘ì„±í•  ë•ŒëŠ” ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìˆëŠ”ë°</p>
<p>ì´ ë‚´ìš©ì€ ë³„ë„ì˜ ë¬¸ì„œë¡œ ì •ë¦¬í•˜ê² ë‹¤.</p>
<h2 id="PreAuthorize"><a href="#PreAuthorize" class="headerlink" title="@PreAuthorize"></a><code>@PreAuthorize</code></h2><p><code>@PreAuthorize</code>ëŠ” ë©”ì†Œë“œ í˜¸ì¶œ ì „, ê¶Œí•œì„ ê²€ì¦í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankService</span> &#123;</span><br><span class="line">	<span class="meta">@PreAuthorize(&quot;hasRole(&#x27;ADMIN&#x27;)&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Account <span class="title function_">readAccount</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ ë©”ì†Œë“œëŠ” í˜¸ì¶œí•˜ê¸° ì „ì— <code>Authentication</code> ê°ì²´ê°€ <code>ROLE_ADMIN</code> Roleì´ ìˆëŠ”ì§€ ì²´í¬í•˜ê³ </p>
<p>Roleì´ ì—†ë‹¤ë©´ <code>AccessDeniedException</code>ì´ ë˜ì ¸ì§„ë‹¤.</p>
<p><code>MockUser</code>ë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">BankService bankService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(roles=&quot;ADMIN&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">readAccountWithAdminRoleThenInvokes</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> bankService.readAccount(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(roles=&quot;USER&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">readAccountWithUserRoleThenAccessDenied</span><span class="params">()</span> &#123;</span><br><span class="line">    assertThatExceptionOfType(AccessDeniedException.class).isThrownBy(</span><br><span class="line">        () -&gt; <span class="built_in">this</span>.bankService.readAccount(<span class="string">&quot;1&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PostAuthorize"><a href="#PostAuthorize" class="headerlink" title="@PostAuthorize"></a><code>@PostAuthorize</code></h2><p><code>@PostAuthorize</code>ëŠ” ë©”ì†Œë“œê°€ í˜¸ì¶œë˜ê³  ë¦¬í„´ë  ë•Œ ê¶Œí•œì„ ê²€ì¦í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankService</span> &#123;</span><br><span class="line">	<span class="meta">@PostAuthorize(&quot;returnObject.owner == authentication.name&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Account <span class="title function_">readAccount</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> account;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ ë©”ì†Œë“œëŠ” ë¦¬í„´ë˜ëŠ” <code>Account</code> ê°ì²´ì˜ <code>owner</code> í”„ë¡œí¼í‹°ê°€</p>
<p><code>Authentication</code> ê°ì²´ì˜ <code>name</code> í”„ë¡œí¼í‹°ì™€ ê°™ì„ ë•Œë§Œ ì •ìƒì ìœ¼ë¡œ ë¦¬í„´ë˜ê³ </p>
<p>ê°™ì§€ ì•Šë‹¤ë©´ ë§ˆì°¬ê°€ì§€ë¡œ <code>AccessDeniedException</code>ì´ ë°œìƒí•œë‹¤.</p>
<p>ì•„ë˜ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">BankService bankService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(username=&quot;owner&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">readAccountWhenOwnedThenReturns</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> bankService.readAccount(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="comment">// ... assertions</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(username=&quot;wrong&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">readAccountWhenNotOwnedThenAccessDenied</span><span class="params">()</span> &#123;</span><br><span class="line">    assertThatExceptionOfType(AccessDeniedException.class).isThrownBy(</span><br><span class="line">        () -&gt; <span class="built_in">this</span>.bankService.readAccount(<span class="string">&quot;1&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PreFilter"><a href="#PreFilter" class="headerlink" title="@PreFilter"></a><code>@PreFilter</code></h2><p><code>@PreFilter</code>ëŠ” ë©”ì†Œë“œ í˜¸ì¶œ ì „ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë˜ëŠ” ê°ì²´ë“¤ì„ ì¸ê°€ë¥¼ í†µí•´ í•„í„°ë§í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankService</span> &#123;</span><br><span class="line">	<span class="meta">@PreFilter(&quot;filterObject.owner == authentication.name&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">updateAccounts</span><span class="params">(Account... accounts)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ ë©”ì†Œë“œì—ì„œ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë˜ëŠ” <code>accounts</code> ì•ˆì—ëŠ”</p>
<p><code>owner</code> í”„ë¡œí¼í‹°ê°€ <code>Authentication</code>ì˜ <code>name</code> í”„ë¡œí¼í‹°ì™€ ê°™ì€ ê°ì²´ë§Œ í•„í„°ë§ë¼ì„œ ì „ë‹¬ëœë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">BankService bankService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(username=&quot;owner&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">updateAccountsWhenOwnedThenReturns</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">ownedBy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>(<span class="string">&quot;owner&quot;</span>);</span><br><span class="line">    <span class="type">Account</span> <span class="variable">notOwnedBy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Account</span>(<span class="string">&quot;not owner&quot;</span>);</span><br><span class="line">    List&lt;Account&gt; updated = bankService.updateAccounts(ownedBy, notOwnedBy);</span><br><span class="line">    assertThat(updated).containsOnly(ownedBy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ <code>updateAccounts()</code>ì˜ íŒŒë¼ë¯¸í„°ë¡œ 2ê°œì˜ <code>Account</code> ê°ì²´ë¥¼ ì „ë‹¬í–ˆì§€ë§Œ,</p>
<p><code>@PreFilter</code>ë¡œ ì¸í•´ ì‹¤ì œ ë©”ì†Œë“œ ë‚´ë¶€ì— ì „ë‹¬ë˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” <code>ownedBy</code> ê°ì²´ë§Œ ì „ë‹¬ëœë‹¤.</p>
<p><code>@PreFilter</code>ë¡œ í•„í„°ë§í•  ìˆ˜ ìˆëŠ” íŒŒë¼ë¯¸í„° íƒ€ì…ì€ ë°°ì—´, <code>Collection</code>, <code>Map</code>, <code>Stream</code>ì´ë‹¤.<br>(<code>Stream</code>ì€ ë‹«íˆì§€ ì•Šì€ ìƒíƒœì—¬ì•¼ í•œë‹¤.)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PreFilter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccounts</span><span class="params">(Account[] accounts)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PreFilter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccounts</span><span class="params">(Collection&lt;Account&gt; accounts)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PreFilter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccounts</span><span class="params">(Map&lt;String, Account&gt; accounts)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PreFilter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccounts</span><span class="params">(Stream&lt;Account&gt; accounts)</span></span><br></pre></td></tr></table></figure>

<h2 id="PostFilter"><a href="#PostFilter" class="headerlink" title="@PostFilter"></a><code>@PostFilter</code></h2><p><code>@PostFilter</code>ëŠ” ë©”ì†Œë“œê°€ ë¦¬í„´í•˜ëŠ” ê°ì²´ë“¤ì„ ì¸ê°€ë¥¼ í†µí•´ í•„í„°ë§í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankService</span> &#123;</span><br><span class="line">	<span class="meta">@PostFilter(&quot;filterObject.owner == authentication.name&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Collection&lt;Account&gt; <span class="title function_">readAccounts</span><span class="params">(String... ids)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ ì½”ë“œëŠ” ë¦¬í„´ë˜ëŠ” <code>accounts</code> ì»¬ë ‰ì…˜ì—ì„œ ê°ì²´ë“¤ì˜ <code>owner</code> í”„ë¡œí¼í‹°ê°€</p>
<p><code>Authentication</code>ì˜ <code>name</code> í”„ë¡œí¼í‹°ì™€ ê°™ì€ ê°ì²´ë§Œ í•„í„°ë§ë˜ì–´ ë¦¬í„´ëœë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p>
<p>ì•„ë˜ì™€ ê°™ì€ í…ŒìŠ¤íŠ¸ì½”ë“œë¡œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">BankService bankService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WithMockUser(username=&quot;owner&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">readAccountsWhenOwnedThenReturns</span><span class="params">()</span> &#123;</span><br><span class="line">    Collection&lt;Account&gt; accounts = bankService.updateAccounts(<span class="string">&quot;owner&quot;</span>, <span class="string">&quot;not-owner&quot;</span>);</span><br><span class="line">    assertThat(accounts).hasSize(<span class="number">1</span>);</span><br><span class="line">    assertThat(accounts.get(<span class="number">0</span>).getOwner()).isEqualTo(<span class="string">&quot;owner&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@PostFilter</code>ë¡œ í•„í„°ë§í•  ìˆ˜ ìˆëŠ” ë¦¬í„´ íƒ€ì…ì€ ë°°ì—´, <code>Collection</code>, <code>Map</code>, <code>Stream</code>ì´ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostFilter</span></span><br><span class="line"><span class="keyword">public</span> Account[] readAccounts()</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostFilter</span></span><br><span class="line"><span class="keyword">public</span> Collection&lt;Account&gt; <span class="title function_">readAccounts</span><span class="params">()</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PostFilter</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Account&gt; <span class="title function_">readAccounts</span><span class="params">()</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PostFilter</span></span><br><span class="line"><span class="keyword">public</span> Stream&lt;Account&gt; <span class="title function_">readAccounts</span><span class="params">()</span></span><br></pre></td></tr></table></figure>

<p><strong>ì£¼ì˜ì‚¬í•­</strong></p>
<blockquote>
<p><code>@PreFilter</code>ë‚˜ <code>@PostFilter</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì‚¬ì´ì¦ˆê°€ í° ì»¬ë ‰ì…˜ì„ í•„í„°ë§í•˜ëŠ” ì‘ì—…ì€<br>ë©”ëª¨ë¦¬ë¥¼ ë§¤ìš° ë§ì´ ì†Œëª¨í•œë‹¤. ìì¹« ì˜ëª»í•˜ë©´ OOMì´ ë°œìƒí•  ìˆ˜ë„ ìˆë‹¤.<br>ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì‚¬ì´ì¦ˆê°€ í° ì»¬ë ‰ì…˜ì„ ê°€ì ¸ì™€ì„œ í•„í„°ë§í•˜ê¸°ë³´ë‹¤ëŠ”<br>ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ë¨¼ì € í•„í„°ë§í•´ì„œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ íƒí•´ì•¼ í•œë‹¤.<br>ì¦‰, SQLì´ë‚˜ NoSQLë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œë¶€í„° ì ì ˆí•œ ì¡°ê±´ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¨¼ì € í•„í„°ë§í•´ì•¼ í•œë‹¤.</p>
</blockquote>
<h2 id="ê¸°íƒ€-ì• ë„ˆí…Œì´ì…˜"><a href="#ê¸°íƒ€-ì• ë„ˆí…Œì´ì…˜" class="headerlink" title="ê¸°íƒ€ ì• ë„ˆí…Œì´ì…˜"></a>ê¸°íƒ€ ì• ë„ˆí…Œì´ì…˜</h2><h3 id="Secured"><a href="#Secured" class="headerlink" title="@Secured"></a><code>@Secured</code></h3><p><code>@Secured</code>ëŠ” <code>@PreAuthorize</code>ì˜ ë ˆê±°ì‹œ ë²„ì „ì´ë©° ì‚¬ìš©í•˜ë ¤ë©´</p>
<p><code>@EnableMethodSecurity(securedEnabled = true)</code> ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤.</p>
<h3 id="JSR-250-ì• ë„ˆí…Œì´ì…˜"><a href="#JSR-250-ì• ë„ˆí…Œì´ì…˜" class="headerlink" title="JSR-250 ì• ë„ˆí…Œì´ì…˜"></a>JSR-250 ì• ë„ˆí…Œì´ì…˜</h3><p>JSR-250 ì• ë„ˆí…Œì´ì…˜ì—ëŠ” <code>@RolseAllowed</code>, <code>@PermitAll</code>, <code>@DenyAll</code> ë“±ì´ ìˆìœ¼ë©° ì‚¬ìš©í•˜ë ¤ë©´</p>
<p><code>@EnableMethodSecurity(jsr250Enabled = true)</code> ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤.</p>
<h2 id="í´ë˜ìŠ¤-ë ˆë²¨-ì• ë„ˆí…Œì´ì…˜"><a href="#í´ë˜ìŠ¤-ë ˆë²¨-ì• ë„ˆí…Œì´ì…˜" class="headerlink" title="í´ë˜ìŠ¤ ë ˆë²¨ ì• ë„ˆí…Œì´ì…˜"></a>í´ë˜ìŠ¤ ë ˆë²¨ ì• ë„ˆí…Œì´ì…˜</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;hasAuthority(&#x27;ROLE_USER&#x27;)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserApiController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/endpoint&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">endpoint</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ì™€ ê°™ì´ í´ë˜ìŠ¤ ë ˆë²¨ë¡œ ì• ë„ˆí…Œì´ì…˜ì„ ì¶”ê°€í•  ìˆ˜ ìˆê³  í•´ë‹¹ í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì†Œë“œì— ì ìš©ëœë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;hasAuthority(&#x27;ROLE_USER&#x27;)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserApiController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/admin&quot;)</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;hasAuthority(&#x27;ROLE_ADMIN&#x27;)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">admin</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ì²˜ëŸ¼ ì˜ˆì™¸ë¡œ ë‹¤ë¥¸ í‘œí˜„ì‹ì„ ì‚¬ìš©í•´ì•¼í•  ê²½ìš°ì—ëŠ” í•´ë‹¹ ë©”ì†Œë“œì— ì• ë„ˆí…Œì´ì…˜ì„ ì˜¤ë²„ë¼ì´ë“œí•  ìˆ˜ ìˆë‹¤.</p>
<h2 id="ë©”íƒ€-ì• ë„ˆí…Œì´ì…˜-ì»¤ìŠ¤í…€-ì• ë„ˆí…Œì´ì…˜"><a href="#ë©”íƒ€-ì• ë„ˆí…Œì´ì…˜-ì»¤ìŠ¤í…€-ì• ë„ˆí…Œì´ì…˜" class="headerlink" title="ë©”íƒ€ ì• ë„ˆí…Œì´ì…˜ (ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜)"></a>ë©”íƒ€ ì• ë„ˆí…Œì´ì…˜ (ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜)</h2><p>ìœ„ì—ì„œ ì†Œê°œí•œ <code>@PreAuthorize</code>, <code>@PostAuthorize</code> ë“±ì˜ ì• ë„ˆí…Œì´ì…˜ì— ë˜‘ê°™ì€ í‘œí˜„ì‹ì„</p>
<p>ê³„ì† ì ëŠ” ê²ƒì€ ë¶„ëª… ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ì§€ ì•Šë‹¤.</p>
<p>ì´ë¥¼ ìœ„í•´ ë©”íƒ€ ì• ë„ˆí…Œì´ì…˜ì´ë¼ ë¶ˆë¦¬ëŠ” ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜ì„ ë§Œë“¤ì–´ì„œ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123; ElementType.METHOD, ElementType.TYPE &#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@PreAuthorize(&quot;hasRole(&#x27;ADMIN&#x27;)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> IsAdmin &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ìœ„ì²˜ëŸ¼ ì• ë„ˆí…Œì´ì…˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankService</span> &#123;</span><br><span class="line">	<span class="meta">@IsAdmin</span></span><br><span class="line">	<span class="keyword">public</span> Account <span class="title function_">readAccount</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì™€ ê°™ì´ ì»¤ìŠ¤í…€ ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œ <code>@PreAuthorize(&quot;hasRole(&#39;ADMIN&#39;)&quot;)</code>ì™€ ê°™ì€ íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆë‹¤.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/04/11/spring-aop-pointcut/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/11/spring-aop-pointcut/" class="post-title-link" itemprop="url">Spring AOP í¬ì¸íŠ¸ì»·(Pointcut)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-04-11 09:21:20 / Modified: 11:53:57" itemprop="dateCreated datePublished" datetime="2024-04-11T09:21:20+09:00">2024-04-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="í¬ì¸íŠ¸ì»·-Pointcut-ì´ë€"><a href="#í¬ì¸íŠ¸ì»·-Pointcut-ì´ë€" class="headerlink" title="í¬ì¸íŠ¸ì»·(Pointcut)ì´ë€?"></a>í¬ì¸íŠ¸ì»·(Pointcut)ì´ë€?</h1><p>í¬ì¸íŠ¸ì»·ì€ Adviceê°€ ì–¸ì œ ì‹¤í–‰ë ì§€ ì¡°ì¸ í¬ì¸íŠ¸ ì¤‘ì—ì„œ ê³¨ë¼ë‚´ëŠ” ì‘ì—…ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.</p>
<p>ì¦‰, ì–´ë“œë°”ì´ìŠ¤ê°€ ì–´ë–¤ ë©”ì†Œë“œë“¤ì—ì„œ ì‹¤í–‰ë ì§€ ê³¨ë¼ë‚´ëŠ” ì‘ì—…ì´ë‹¤.</p>
<p>ìŠ¤í”„ë§ AOPì—ì„œëŠ” ìŠ¤í”„ë§ ë¹ˆì˜ ë©”ì†Œë“œ ì‹¤í–‰ì— ëŒ€í•œ ì¡°ì¸ í¬ì¸íŠ¸ë§Œ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ìŠ¤í”„ë§ì—ì„œ í¬ì¸íŠ¸ì»·ì€ ìŠ¤í”„ë§ ë¹ˆì˜ ë©”ì†Œë“œì™€ ì—°ê²°ëœë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>
<br>

<h1 id="í¬ì¸íŠ¸ì»·-ì„ ì–¸"><a href="#í¬ì¸íŠ¸ì»·-ì„ ì–¸" class="headerlink" title="í¬ì¸íŠ¸ì»· ì„ ì–¸"></a>í¬ì¸íŠ¸ì»· ì„ ì–¸</h1><p>í¬ì¸íŠ¸ì»·ì„ ì„ ì–¸í•  ë•ŒëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ê°€ í•„ìš”í•˜ë‹¤.</p>
<ol>
<li>ì‹œê·¸ë‹ˆì³ (Signature)</li>
<li>í¬ì¸íŠ¸ì»· í‘œí˜„ì‹ (Pointcut Expression)</li>
</ol>
<p>AspectJì—ì„œ ì‹œê·¸ë‹ˆì³ë€ ì‰½ê²Œ ë§í•´ Javaì˜ ë©”ì†Œë“œì´ë‹¤. ì´ë¦„ê³¼ íŒŒë¼ë¯¸í„°ë¡œ ì‹ë³„ ê°€ëŠ¥í•œ ê³ ìœ í•œ ë©”ì†Œë“œì´ê³  ê¼­ <code>void</code> íƒ€ì…ì´ì–´ì•¼ í•œë‹¤.</p>
<p>í¬ì¸íŠ¸ì»· í‘œí˜„ì‹ì´ë€ ì–´ë–¤ ë©”ì†Œë“œê°€ ì‹¤í–‰ë  ë•Œ ì´ ì• ìŠ¤í™íŠ¸ê°€ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” í‘œí˜„ì‹ì´ë‹¤.</p>
<p>AspectJì—ì„œ í¬ì¸íŠ¸ì»·ì€ ë‹¤ìŒê³¼ ê°™ì´ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(* transfer(..))&quot;)</span> <span class="comment">// í¬ì¸íŠ¸ì»· í‘œí˜„ì‹</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">anyOldTransfer</span><span class="params">()</span> &#123;&#125; <span class="comment">// Signature</span></span><br></pre></td></tr></table></figure>

<p>ìœ„ í¬ì¸íŠ¸ì»·ì˜ ì‹œê·¸ë‹ˆì³ëŠ” <code>anyOldTransfer</code>ë¼ëŠ” ì´ë¦„ê³¼ 0ê°œì˜ íŒŒë¼ë¯¸í„°ë¡œ êµ¬ì„±ë¼ìˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  í¬ì¸íŠ¸ì»· í‘œí˜„ì‹ì€ <code>@Pointcut(&quot;execution(* transfer(..))&quot;)</code>ê°€ ëœë‹¤.</p>
<br>

<h1 id="ìŠ¤í”„ë§-AOPì˜-í¬ì¸íŠ¸ì»·-í‘œí˜„ì‹"><a href="#ìŠ¤í”„ë§-AOPì˜-í¬ì¸íŠ¸ì»·-í‘œí˜„ì‹" class="headerlink" title="ìŠ¤í”„ë§ AOPì˜ í¬ì¸íŠ¸ì»· í‘œí˜„ì‹"></a>ìŠ¤í”„ë§ AOPì˜ í¬ì¸íŠ¸ì»· í‘œí˜„ì‹</h1><p>ìŠ¤í”„ë§ AOPì—ì„œ ì§€ì›í•˜ëŠ” AspectJì˜ í¬ì¸íŠ¸ì»· ì§€ì •ì (Pointcut designator, PCD) ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:</p>
<h2 id="execution"><a href="#execution" class="headerlink" title="execution"></a><code>execution</code></h2><p>ì–´ë–¤ ë©”ì†Œë“œê°€ ì‹¤í–‰ë  ë•Œì¸ì§€ë¥¼ ì§€ì •í•œë‹¤.</p>
<p><code>execution([ì ‘ê·¼ì] íƒ€ì… [í´ë˜ìŠ¤].ì´ë¦„(íŒŒë¼ë¯¸í„°))</code></p>
<ul>
<li>ì ‘ê·¼ì: <code>public</code>, <code>private</code> ë“±ì˜ ì ‘ê·¼ ì œì–´ì. ìƒëµ ê°€ëŠ¥.</li>
<li>íƒ€ì…: ë©”ì†Œë“œì˜ ë¦¬í„´ íƒ€ì….</li>
<li>í´ë˜ìŠ¤: íŒ¨í‚¤ì§€ëª…ì„ í¬í•¨í•œ í´ë˜ìŠ¤ëª…. ìƒëµ ê°€ëŠ¥.</li>
<li>ì´ë¦„: ë©”ì†Œë“œ ì´ë¦„.</li>
<li>íŒŒë¼ë¯¸í„°: ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„° íƒ€ì….<ul>
<li><code>*</code>: ëª¨ë“  íƒ€ì….</li>
<li><code>..</code>: 0ê°œ ì´ìƒì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(public String com.baeldung.pointcutadvice.dao.FooDao.findById(Long))&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì™€ ê°™ì€ í¬ì¸íŠ¸ì»· í‘œí˜„ì‹ì´ ìˆë‹¤ë©´</p>
<p>ì ‘ê·¼ìëŠ” <code>public</code>, ë¦¬í„´ íƒ€ì…ì€ <code>String</code>, í´ë˜ìŠ¤ëŠ” <code>com.baeldung.pointcutadvice.dao.FooDao</code>, ë©”ì†Œë“œ ì´ë¦„ì€ <code>findById</code>, íŒŒë¼ë¯¸í„°ëŠ” <code>Long</code> íƒ€ì… 1ê°œë§Œ ê°–ê³  ìˆëŠ” ë©”ì†Œë“œë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì´ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(* com.baeldung.pointcutadvice.dao.FooDao.*(..))&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ìœ„ í‘œí˜„ì‹ì—ì„œëŠ” ì ‘ê·¼ìëŠ” ìƒëµë˜ì—ˆê³  ë¦¬í„´ íƒ€ì…ì€ <code>*</code> ë¡œ ëª¨ë“  íƒ€ì…ì´ê³ , í´ë˜ìŠ¤ëŠ” <code>com.baeldung.pointcutadvice.dao.FooDao</code>, ë©”ì†Œë“œ ì´ë¦„ì€ <code>*</code>ë¡œ ëª¨ë“  ë©”ì†Œë“œì´ë©° íŒŒë¼ë¯¸í„°ëŠ” <code>..</code>ë¡œ ê°¯ìˆ˜ì™€ íƒ€ì…ì— ìƒê´€ì—†ì´ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì§€ì •í•˜ê²Œ ëœë‹¤.</p>
<h2 id="within"><a href="#within" class="headerlink" title="within"></a><code>within</code></h2><p>ì–´ë–¤ íƒ€ì… ì•ˆì— ìˆëŠ” ë©”ì†Œë“œì¸ì§€ ì§€ì •í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;within(com.baeldung.pointcutadvice.dao.FooDao)&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ëŠ” <code>FooDao</code> ë‚´ì˜ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•˜ê³ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;within(com.baeldung..*)&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ëŠ” <code>com.baeldung</code> íŒ¨í‚¤ì§€ì™€ ê·¸ í•˜ìœ„ì˜ ëª¨ë“  íŒ¨í‚¤ì§€ì˜ ëª¨ë“  íƒ€ì… ì•ˆì˜ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<h2 id="this-ì™€-target"><a href="#this-ì™€-target" class="headerlink" title="this ì™€ target"></a><code>this</code> ì™€ <code>target</code></h2><p><code>this</code>ì™€ <code>target</code>ì€ AOPê°€ í”„ë¡ì‹œë¥¼ ìƒì„±í•  ë•Œ CGLIB ë°©ì‹ì¸ì§€ JDK dynamic ë°©ì‹ì¸ì§€ì— ë”°ë¼ ì„ íƒí•´ì•¼ í•œë‹¤.</p>
<p>ë§Œì•½ <code>IFooService</code>ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ê°€ ìˆê³  ì´ë¥¼ êµ¬í˜„í•œ <code>FooServiceImpl</code> í´ë˜ìŠ¤ê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FooServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">IFooService</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì´ ê²½ìš°ì—ëŠ” ìŠ¤í”„ë§ AOPëŠ” JDK dynamic í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— <code>target</code> í‘œí˜„ì‹ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(target(com.xyz.IFooService))</span></span><br></pre></td></tr></table></figure>

<p><code>A instanceof IFooService</code> ê°€ trueì¸ ëª¨ë“  Aì˜ ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<br>

<p>ë§Œì•½ <code>FooServiceImpl</code>ê°€ ë‹¤ìŒì²˜ëŸ¼ ì•„ë¬´ ì¸í„°í˜ì´ìŠ¤ë„ êµ¬í˜„í•˜ì§€ ì•Šê³  ìˆë‹¤ë©´,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FooServiceImpl</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ì´ ê²½ìš°ì—ëŠ” ìƒì„±ë˜ëŠ” í”„ë¡ì‹œê°€ <code>FooServiceImpl</code>ì˜ ìì‹ í´ë˜ìŠ¤ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì—</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(target(com.xyz.FooServiceImpl))</span></span><br></pre></td></tr></table></figure>

<p>ì²˜ëŸ¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<h2 id="args"><a href="#args" class="headerlink" title="args"></a><code>args</code></h2><p>ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ ëŸ°íƒ€ì„ ê°ì²´ì˜ íƒ€ì…ì´ ì§€ì •ëœ íƒ€ì…ì¼ ê²½ìš°ì— ì ìš©ëœë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ ì–´ë–¤ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ <code>String</code> íƒ€ì…ì´ ì „ë‹¬ë  ë•Œ ì ìš©í•˜ê³  ì‹¶ë‹¤ë©´</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;args(java.lang.String)&quot;)</span></span><br></pre></td></tr></table></figure>

<h3 id="executionê³¼-ì°¨ì´ì "><a href="#executionê³¼-ì°¨ì´ì " class="headerlink" title="executionê³¼ ì°¨ì´ì "></a><code>execution</code>ê³¼ ì°¨ì´ì </h3><p><code>execution(* *(java.lang.String))</code>ì€ <code>String</code> íƒ€ì…ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ”ë‹¤ê³  ì„ ì–¸ëœ ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•˜ê³ </p>
<p><code>args(java.lang.String)</code>ì€ ëŸ°íƒ€ì„ì— ì „ë‹¬ëœ íŒŒë¼ë¯¸í„°ì˜ íƒ€ì…ì´ <code>String</code> íƒ€ì…ì¸ ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<p>ë‹¤ìŒê³¼ ê°™ì´ ë‘ ë©”ì†Œë“œê°€ ìˆëŠ”ë° í•˜ë‚˜ëŠ” <code>List</code> íƒ€ì…ìœ¼ë¡œ ì„ ì–¸ë¼ìˆê³  í•˜ë‚˜ëŠ” <code>ArrayList</code> íƒ€ì…ìœ¼ë¡œ ì„ ì–¸ë¼ìˆë‹¤ê³  ê°€ì •í•˜ì.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">(List&lt;String&gt; list)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method2</span><span class="params">(ArrayList&lt;String&gt; arrayList)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ê·¸ë¦¬ê³  ë§Œì•½ <code>method(new ArrayList&lt;&gt;());</code>ë¥¼ í˜¸ì¶œí•œë‹¤ê³  í•˜ë©´</p>
<p>ì´ ê²½ìš°ì— <code>execution(* *(java.util.ArrayList))</code>ëŠ” <code>method2</code>ì—ë§Œ ì ìš©ë˜ëŠ” ê²ƒì´ê³ </p>
<p><code>args(java.util.ArrayList)</code>ëŠ” <code>method</code>ì™€ <code>method2</code> ë‘˜ ë‹¤ì— ì ìš©ë˜ëŠ” ê²ƒì´ë‹¤.</p>
<h2 id="target"><a href="#target" class="headerlink" title="@target"></a><code>@target</code></h2><p>ìœ„ì—ì„œ ì„¤ëª…í•œ <code>target</code>ê³¼ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ ì£¼ì˜í•´ì•¼ í•œë‹¤.</p>
<p>ì§€ì •í•œ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;@target(org.springframework.stereotype.Repository)&quot;)</span></span><br></pre></td></tr></table></figure>

<h2 id="args-1"><a href="#args-1" class="headerlink" title="@args"></a><code>@args</code></h2><p>ìœ„ì—ì„œ ì„¤ëª…í•œ <code>args</code>ì™€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ ì£¼ì˜í•´ì•¼ í•œë‹¤.</p>
<p>ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ ëŸ°íƒ€ì„ ê°ì²´ì˜ ì‹¤ì œ íƒ€ì…ì´ ì§€ì •ëœ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” í´ë˜ìŠ¤ì¼ ê²½ìš°ì— ì ìš©ëœë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ ì–´ë–¤ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ <code>@Entity</code>ê°€ ë¶™ì€ í´ë˜ìŠ¤ì˜ ê°ì²´ê°€ ì „ë‹¬ë  ë•Œ ì ìš©í•˜ê³  ì‹¶ë‹¤ê³  ê°€ì •í•˜ë©´</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;@args(com.baeldung.pointcutadvice.annotations.Entity)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">methodsAcceptingEntities</span><span class="params">()</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ë¡œ ì§€ì •í•˜ê²Œ ë˜ë©´ <code>@Entity</code>ê°€ ë¶™ì€ ê°ì²´ê°€ ì „ë‹¬ë˜ëŠ” ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<p>ì´ë ‡ê²Œ ì§€ì •í•œ í¬ì¸íŠ¸ì»·ì˜ íŒŒë¼ë¯¸í„°ì— ì ‘ê·¼í•˜ë ¤ë©´ adviceì—ì„œ <code>JoinPoint</code> ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;methodsAcceptingEntities()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logMethodAcceptionEntityAnnotatedBean</span><span class="params">(JoinPoint jp)</span> &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">entity</span> <span class="operator">=</span> jp.getArgs()[<span class="number">0</span>]; <span class="comment">// @Entityê°€ ì„ ì–¸ëœ ê°ì²´</span></span><br><span class="line">    logger.info(<span class="string">&quot;Accepting beans with @Entity annotation: &quot;</span> + entity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="within-1"><a href="#within-1" class="headerlink" title="@within"></a><code>@within</code></h2><p><code>within</code>ê³¼ ë‹¤ë¥´ë‹¤ëŠ” ì ì„ ì£¼ì˜í•œë‹¤.</p>
<p><code>within</code>ê³¼ ê±°ì˜ ë¹„ìŠ·í•˜ì§€ë§Œ <code>@within</code>ì€ ì§€ì •í•œ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” íƒ€ì…ì˜ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;@within(org.springframework.stereotype.Repository)&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ëŠ” ì•„ë˜ì™€ ë™ì¼í•œ í‘œí˜„ì‹ì´ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;within(@org.springframework.stereotype.Repository *)&quot;)</span></span><br></pre></td></tr></table></figure>

<h2 id="annotation"><a href="#annotation" class="headerlink" title="@annotation"></a><code>@annotation</code></h2><p>ì§€ì •ëœ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” ë©”ì†Œë“œì— ì ìš©ëœë‹¤.</p>
<p><code>@within</code>ì€ ì§€ì •ëœ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” íƒ€ì…ì˜ ëª¨ë“  ë©”ì†Œë“œì— ì ìš©ë˜ëŠ” ê²ƒì´ê³  <code>@annotation</code>ì€ ì§€ì •ëœ ì• ë„ˆí…Œì´ì…˜ì„ ê°–ê³  ìˆëŠ” ë©”ì†Œë“œì— ì ìš©ë˜ëŠ” ì°¨ì´ì ì´ ìˆë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ <code>@Loggable</code>ì´ë¼ëŠ” ì• ë„ˆí…Œì´ì…˜ì„ ë§Œë“¤ì–´ì„œ ë©”ì†Œë“œì— ì¶”ê°€í•œë‹¤ë©´</p>
<p><code>@Loggable</code>ì´ ë¶™ì€ ëª¨ë“  ë©”ì†Œë“œì— ëŒ€í•´ ì•„ë˜ì™€ ê°™ì´ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;@annotation(com.baeldung.pointcutadvice.annotations.Loggable)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">loggableMethods</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;loggableMethods()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logMethod</span><span class="params">(JoinPoint jp)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> jp.getSignature().getName();</span><br><span class="line">    logger.info(<span class="string">&quot;Executing method: &quot;</span> + methodName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="bean"><a href="#bean" class="headerlink" title="bean"></a><code>bean</code></h2><p>ì´ ì§€ì •ìëŠ” <strong>AspectJì—ëŠ” ì—†ëŠ” ì§€ì •ì</strong>ë¡œ ìŠ¤í”„ë§ AOPì—ì„œ ìì²´ ì§€ì›í•œë‹¤.</p>
<p>ì§€ì •í•œ ë¹ˆì˜ ëª¨ë“  ë©”ì†Œë“œë¥¼ ì˜ë¯¸í•œë‹¤. <code>*</code>ë¥¼ í†µí•œ ì™€ì¼ë“œì¹´ë“œ í‘œí˜„ì‹ì„ ì§€ì›í•œë‹¤.</p>
<h2 id="ì´ì™¸ì˜-PCD"><a href="#ì´ì™¸ì˜-PCD" class="headerlink" title="ì´ì™¸ì˜ PCD"></a>ì´ì™¸ì˜ PCD</h2><p>ìŠ¤í”„ë§ AOPì—ì„œëŠ” ìœ„ì—ì„œ ì†Œê°œí•œ í¬ì¸íŠ¸ì»· ì§€ì •ì ì´ì™¸ì— ë‹¤ë¥¸ AspectJ ì§€ì •ìë¥¼ ì‚¬ìš©í•˜ë©´ <code>IllegalArgumentException</code>ì´ ë°œìƒí•œë‹¤.</p>
<br>

<h1 id="í¬ì¸íŠ¸ì»·-ì¡°í•©"><a href="#í¬ì¸íŠ¸ì»·-ì¡°í•©" class="headerlink" title="í¬ì¸íŠ¸ì»· ì¡°í•©"></a>í¬ì¸íŠ¸ì»· ì¡°í•©</h1><p>í¬ì¸íŠ¸ì»·ì€ ì ìš©ë  ëŒ€ìƒ ë©”ì†Œë“œë¥¼ ì§‘í•©ì²˜ëŸ¼ ë‚˜íƒ€ë‚´ëŠ” í‘œí˜„ì‹ì´ë¯€ë¡œ ì—¬ëŸ¬ í¬ì¸íŠ¸ì»·ì„ ì¡°í•©í•´ì„œ ì§‘í•©ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<p>ì‚¬ìš© ê°€ëŠ¥í•œ ì—°ì‚°ìëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li><code>&amp;&amp;</code> : ë‘ í¬ì¸íŠ¸ì»·ì˜ êµì§‘í•©</li>
<li><code>||</code> : ë‘ í¬ì¸íŠ¸ì»·ì˜ í•©ì§‘í•©</li>
<li><code>!</code> : ì—¬ì§‘í•©</li>
</ul>
<br>

<h1 id="í¬ì¸íŠ¸ì»·-ê³µìœ "><a href="#í¬ì¸íŠ¸ì»·-ê³µìœ " class="headerlink" title="í¬ì¸íŠ¸ì»· ê³µìœ "></a>í¬ì¸íŠ¸ì»· ê³µìœ </h1><p>ê·œëª¨ê°€ í° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ë•ŒëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ê³µí†µ í¬ì¸íŠ¸ì»·ì„ ë¬¶ì–´ì„œ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ ê²ƒì„ ì¶”ì²œí•œë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ë©´, ì•„ë˜ì™€ ê°™ì´ <code>CommonPointcuts</code>ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xyz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonPointcuts</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * dao íŒ¨í‚¤ì§€ ë°‘ì˜ ëª¨ë“  í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì†Œë“œì— ì ìš©</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Pointcut(&quot;within(com.xyz.dao..*)&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">inDataAccessLayer</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * service íŒ¨í‚¤ì§€ í•˜ìœ„ì— ìˆëŠ” ëª¨ë“  íƒ€ì…ì˜ ëª¨ë“  ë©”ì†Œë“œ ì§€ì •.</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * ë§Œì•½ Service ë¹ˆ ì´ë¦„ì´ ëª¨ë‘ ~Serviceë¡œ ëë‚œë‹¤ë©´</span></span><br><span class="line"><span class="comment">     * bean(*Service)ë¡œ ì§€ì •í•´ë„ ì¢‹ë‹¤.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(* com.xyz..service.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">businessService</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Adviceë¥¼ ë§Œë“¤ ë•Œ ê³µí†µ í¬ì¸íŠ¸ì»·ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;com.xyz.CommonPointcuts.businessService()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeBusinessServiceMethods</span><span class="params">()</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="í¬ì¸íŠ¸ì»·-ì˜-ì‘ì„±í•˜ê¸°"><a href="#í¬ì¸íŠ¸ì»·-ì˜-ì‘ì„±í•˜ê¸°" class="headerlink" title="í¬ì¸íŠ¸ì»· ì˜ ì‘ì„±í•˜ê¸°"></a>í¬ì¸íŠ¸ì»· ì˜ ì‘ì„±í•˜ê¸°</h1><p>ì–´ë–¤ ë©”ì†Œë“œê°€ í•´ë‹¹ í¬ì¸íŠ¸ì»·ì— ì í•©í•œì§€ ì°¾ì•„ë‚´ëŠ” ê²ƒì€ ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ì‘ì—…ì´ë‹¤.</p>
<p>íŠ¹íˆ ë™ì ìœ¼ë¡œ ìƒì„±ëœ ë¹ˆì˜ ë©”ì†Œë“œëŠ” ë”ìš±ë” ë¹„ìš©ì´ ë§ì´ ë“ ë‹¤.</p>
<p>ê·¸ë˜ì„œ AspectJëŠ” ì»´íŒŒì¼í•  ë•Œ í¬ì¸íŠ¸ì»·ì„ ëª¨ë‘ ì°¾ì•„ë‚´ì„œ ê²€ì‚¬í•˜ê¸° ì‰¬ìš´ ë©”ì†Œë“œ ìˆœì„œë¡œ ì •ë ¬í•œë‹¤.</p>
<p>ì¢‹ì€ í¬ì¸íŠ¸ì»·ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ í¬ì¸íŠ¸ì»·ì˜ ëª©í‘œë¥¼ ìƒê°í•˜ê³  ìµœëŒ€í•œ ë©”ì†Œë“œ ì§‘í•©ì˜ ë²”ìœ„ë¥¼ ì¢í˜€ì•¼ í•œë‹¤.</p>
<p>í¬ì¸íŠ¸ì»· ì§€ì •ì(PCD)ëŠ” ë‹¤ìŒ ì„¸ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
<li>Kinded<ul>
<li>íŠ¹ì • ì¡°ì¸í¬ì¸íŠ¸(ë©”ì†Œë“œ)ë§Œ ì„ íƒ : <code>execution</code></li>
</ul>
</li>
<li>Scoping<ul>
<li>ì¡°ì¸í¬ì¸íŠ¸ì˜ ê·¸ë£¹ì„ ì„ íƒ : <code>within</code></li>
</ul>
</li>
<li>Contextual<ul>
<li>ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì„ íƒ : <code>this</code>, <code>target</code>, <code>@annotation</code></li>
</ul>
</li>
</ul>
<p>í¬ì¸íŠ¸ì»·ì„ ì˜ ì‘ì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ìµœì†Œí•œ <code>kinded</code>ì™€ <code>scoping</code>ì„ í¬í•¨í•´ì•¼ í•œë‹¤.</p>
<p><code>Kinded</code> ì§€ì •ìë§Œ ì„ ì–¸í•˜ê±°ë‚˜ <code>Contextual</code> ì§€ì •ìë§Œ ì„ ì–¸í•œ í¬ì¸íŠ¸ì»·ì€ ì‘ë™ì€ í•˜ì§€ë§Œ ì‹œê°„, ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±ì—ì„œ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤.</p>
<p><code>Scoping</code> ì§€ì •ìëŠ” íŠ¹ì • ê·¸ë£¹ë§Œ ëŒ€ìƒìœ¼ë¡œ í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ì¡°ì¸í¬ì¸íŠ¸ë¥¼ ì°¾ì•„ë‚´ëŠ” ê²Œ ë§¤ìš° ë¹ ë¥´ë‹¤.</p>
<p><strong>ì¦‰, ì˜ ì‘ì„±ëœ í¬ì¸íŠ¸ì»·ì€ <code>Scoping</code> ì§€ì •ìë¥¼ í¬í•¨í•œ í¬ì¸íŠ¸ì»·ì´ë‹¤.</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/01/29/virtual-thread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/29/virtual-thread/" class="post-title-link" itemprop="url">ê°€ìƒ ìŠ¤ë ˆë“œ (Virtual Thread)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-29 17:23:07" itemprop="dateCreated datePublished" datetime="2024-01-29T17:23:07+09:00">2024-01-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-31 18:03:30" itemprop="dateModified" datetime="2024-01-31T18:03:30+09:00">2024-01-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ê°€ìƒ-ìŠ¤ë ˆë“œ-ë„ì…-ë°°ê²½"><a href="#ê°€ìƒ-ìŠ¤ë ˆë“œ-ë„ì…-ë°°ê²½" class="headerlink" title="ê°€ìƒ ìŠ¤ë ˆë“œ ë„ì… ë°°ê²½"></a>ê°€ìƒ ìŠ¤ë ˆë“œ ë„ì… ë°°ê²½</h1><p>ì´ì „ë¶€í„° <a target="_blank" rel="noopener" href="https://wiki.openjdk.org/display/loom/Main">Project Loom</a>ì— ëŒ€í•´ì„œ ê´€ì‹¬ì´ ë§ì•˜ë‹¤.</p>
<p>ì§€ê¸ˆê¹Œì§€ ìë°” ì„œë²„ëŠ” ìš”ì²­ íŠ¸ë˜í”½ì´ ëª°ë¦¬ëŠ” ìƒí™©ì—ì„œ ê°’ë¹„ì‹¼ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹˜ ë¹„ìš©ì„ ì§€ë¶ˆí•´ì™”ë‹¤.<br><br><br><strong>ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í•´ì™”ë‹¤.</strong></p>
<ul>
<li>Reactive Streamsì™€ ê°™ì€ ë¹„ë™ê¸° API</li>
<li>ì½”ë£¨í‹´ì„ ìë°”ì— ì¶”ê°€í•˜ê¸°</li>
</ul>
<p>Spring WebFluxëŠ” Reactive APIë¥¼ í›Œë¥­í•˜ê²Œ êµ¬í˜„í•´ì„œ ìŠ¤ë ˆë“œê°€ ë¶€ì¡±í•œ í™˜ê²½ì—ì„œ ì„±ëŠ¥ì„ ê°œì„ í–ˆë‹¤.</p>
<p>ë˜, JVM ì§„ì˜ì˜ ì½”í‹€ë¦°ì—ì„œ coroutineì„ í†µí•´ ë©”ì†Œë“œë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ì§€ì›í•´ì¤¬ë‹¤.<br><br><br><strong>í•˜ì§€ë§Œ ìœ„ì˜ ì‹œë„ë“¤ì€ ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ìë°”ì˜ í‘œì¤€ì´ ë˜ì§€ ëª»í–ˆë‹¤</strong></p>
<ul>
<li>ì›¹í”ŒëŸ­ìŠ¤ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•Šì•„ ë””ë²„ê¹…ì„ ë‹¨ê³„ë³„ë¡œ ì§„í–‰í•  ìˆ˜ ì—†ê³ , ì²˜ë¦¬ë˜ëŠ” ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¼ ìˆ˜ ìˆì–´ stack traceë„ ì œê³µí•  ìˆ˜ ì—†ì—ˆë‹¤.<br></li>
<li>ìë°” í”Œë«í¼ì— ì½”ë£¨í‹´ APIë¥¼ ì ìš©í•˜ë ¤ë©´ ì—„ì²­ë‚œ ëŒ€ê·œëª¨ ì‘ì—…ì´ ë  ìˆ˜ ë°–ì— ì—†ë‹¤. ê¸°ì¡´ì˜ ìŠ¤ë ˆë“œ APIë¥¼ ì‚¬ìš©í•´ ê°œë°œí–ˆë˜ ë‚´ìš©ì€ ëª¨ë‘ ê±·ì–´ë‚´ì•¼ í•œë‹¤.<br></li>
</ul>
<p>ì½”ë£¨í‹´ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì½”í‹€ë¦°ì„ ì‚¬ìš©í•˜ë©´ ë˜ì§€ë§Œ, ì—¬ì „íˆ ìë°”ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ì‚¬ëŒì€ ì½”ë£¨í‹´ë„ í•´ê²°ì±…ì´ ì•„ë‹ˆì—ˆë‹¤.</p>
<p>ì´ ë•Œë¬¸ì— <strong>Project Loom</strong>ì€ ìë°” ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ê¸° ìœ„í•´ 3ê°€ì§€ ê¸°ëŠ¥ì„ ë„ì…í•˜ê¸°ë¡œ í•˜ëŠ”ë° ê·¸ ì¤‘ ì²« ë²ˆì§¸ê°€ <a target="_blank" rel="noopener" href="https://openjdk.org/jeps/425">ê°€ìƒ ìŠ¤ë ˆë“œ(Virtual Thread)</a>ì´ë‹¤.</p>
<br>

<h1 id="ê°€ìƒ-ìŠ¤ë ˆë“œë€"><a href="#ê°€ìƒ-ìŠ¤ë ˆë“œë€" class="headerlink" title="ê°€ìƒ ìŠ¤ë ˆë“œë€?"></a>ê°€ìƒ ìŠ¤ë ˆë“œë€?</h1><p>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” í•œë§ˆë””ë¡œ JVMì— ì˜í•´ ê´€ë¦¬ë˜ëŠ” ê²½ëŸ‰ ìŠ¤ë ˆë“œì´ë‹¤.</p>
<p>ê¸°ì¡´ì˜ JVM ìŠ¤ë ˆë“œëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œ(Platform Thread)ë¼ê³  ë¶€ë¥´ë©° ì´ëŠ” OS ìŠ¤ë ˆë“œë¥¼ ë˜í•‘(Wrapping)í•œ ìŠ¤ë ˆë“œì—¬ì„œ OS ìŠ¤ë ˆë“œì™€ ì¼ëŒ€ì¼ ê´€ê³„ì˜€ë‹¤.<br><br></p>
<h2 id="í”Œë«í¼-ìŠ¤ë ˆë“œì™€-ì°¨ì´"><a href="#í”Œë«í¼-ìŠ¤ë ˆë“œì™€-ì°¨ì´" class="headerlink" title="í”Œë«í¼ ìŠ¤ë ˆë“œì™€ ì°¨ì´"></a>í”Œë«í¼ ìŠ¤ë ˆë“œì™€ ì°¨ì´</h2><p><strong>í”Œë«í¼ ìŠ¤ë ˆë“œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ì ì´ ìˆë‹¤.</strong></p>
<ul>
<li>OS ìŠ¤ë ˆë“œì˜ ë˜í¼ë¡œ êµ¬í˜„í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜ê°€ ì œí•œë¨</li>
<li>OSì— ì˜í•´ ìƒì„±ë˜ê³  ìŠ¤ì¼€ì¤„ë§ë˜ê¸° ë•Œë¬¸ì— ë¹„ìš©ì´ ë¹„ì‹¸ê³  ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš©ë„ ë¹„ì‹¸ë‹¤<br></li>
</ul>
<p><strong>ì´ì— ë¹„í•´ ê°€ìƒ ìŠ¤ë ˆë“œëŠ” JDKì—ì„œ êµ¬í˜„í•˜ê³  ì œê³µí•˜ëŠ” user-mode ìŠ¤ë ˆë“œì´ë‹¤.</strong></p>
<p>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” íŠ¹ì • OS ìŠ¤ë ˆë“œì— ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šê³  M:N ìŠ¤ì¼€ì¤„ë§ì„ ì‚¬ìš©í•œë‹¤. ê°€ìƒ ìŠ¤ë ˆë“œì˜ ìˆ˜(M)ê°€ ë” ì ì€ ìˆ˜(N)ì˜ OS ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ë˜ê²Œ ì˜ˆì•½í•œë‹¤.</p>
<img src="/2024/01/29/virtual-thread/vt.png" class="">

<p>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” CPUì—ì„œ ê³„ì‚°ì„ ìˆ˜í–‰í•  ë•Œë§Œ OS ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<p>ê°€ìƒ ìŠ¤ë ˆë“œì—ì„œ blocking I&#x2F;O ì‘ì—…ì„ ì‹œì‘í•  ë•Œ ìë°”ëŠ” non-blocking OSë¥¼ í˜¸ì¶œí•˜ê³  ê°€ìƒ ìŠ¤ë ˆë“œë¥¼ ì„ì‹œë¡œ ì¤‘ë‹¨í•œë‹¤.<br><br></p>
<h1 id="ê¸°ì¡´-ìŠ¤ë ˆë“œ-ëª¨ë¸ê³¼-ì„±ëŠ¥-ë¹„êµ"><a href="#ê¸°ì¡´-ìŠ¤ë ˆë“œ-ëª¨ë¸ê³¼-ì„±ëŠ¥-ë¹„êµ" class="headerlink" title="ê¸°ì¡´ ìŠ¤ë ˆë“œ ëª¨ë¸ê³¼ ì„±ëŠ¥ ë¹„êµ"></a>ê¸°ì¡´ ìŠ¤ë ˆë“œ ëª¨ë¸ê³¼ ì„±ëŠ¥ ë¹„êµ</h1><p>ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì–´ì„œ ì„±ëŠ¥ ë¹„êµë¥¼ í•´ë³´ì•˜ë‹¤.</p>
<p><strong>ìŠ¤í”„ë§ ë¶€íŠ¸ ë²„ì „</strong></p>
<ul>
<li>Spring Boot 3.2.1</li>
</ul>
<p><strong>ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë„êµ¬</strong></p>
<ul>
<li>Apache JMeter</li>
</ul>
<p><strong>í…ŒìŠ¤íŠ¸ í™˜ê²½ (VM)</strong></p>
<ul>
<li>Centos7 x86_64</li>
<li>CPU 1 core 1 Thread</li>
<li>1GB Memory</li>
<li>JDK 21<br></li>
</ul>
<p>ìš”ì²­ì„ ë°›ìœ¼ë©´ 300msë™ì•ˆ sleepí•˜ê³  ë¦¬í„´í•˜ëŠ” ê°„ë‹¨í•œ APIë¥¼ ë§Œë“¤ì—ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  í˜„ì¬ ìŠ¤ë ˆë“œê°€ ê°€ìƒ ìŠ¤ë ˆë“œì¸ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ <code>Thread.currentThread().isVirtual</code>ì„ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ë„ ë‚¨ê²¼ë‹¤.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.study.controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.GetMapping</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.RestController</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> log = LoggerFactory.getLogger(<span class="keyword">this</span>.javaClass)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        log.info(<span class="string">&quot;VT: &#123;&#125;&quot;</span>, Thread.currentThread().isVirtual)</span><br><span class="line">        Thread.sleep(<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<p>ê·¸ë¦¬ê³  í†°ìº£ì´ ìš”ì²­ì„ ì²˜ë¦¬í•  ë•Œ ê°€ìƒ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ Beanì„ ë“±ë¡í•´ì£¼ì—ˆë‹¤.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.study.config</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.coyote.ProtocolHandler</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.embedded.tomcat.TomcatProtocolHandlerCustomizer</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.<span class="keyword">annotation</span>.Bean</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.<span class="keyword">annotation</span>.Configuration</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">virtualThreadExecutorCustomizer</span><span class="params">()</span></span>: TomcatProtocolHandlerCustomizer&lt;*&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> TomcatProtocolHandlerCustomizer &#123; protocolHandler: ProtocolHandler -&gt;</span><br><span class="line">            protocolHandler.executor = Executors.newVirtualThreadPerTaskExecutor()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<p>ì´ Bean ì„¤ì •ì€ Spring Boot 3.2 ë²„ì „ ì´ìƒì—ì„œëŠ” <code>application.properties</code>ì—ì„œ<br><code>spring.threads.virtual.enabled=true</code>ë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤.<br><br></p>
<h2 id="í…ŒìŠ¤íŠ¸-ê²°ê³¼"><a href="#í…ŒìŠ¤íŠ¸-ê²°ê³¼" class="headerlink" title="í…ŒìŠ¤íŠ¸ ê²°ê³¼"></a>í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2><p>ì²˜ìŒì— ê°€ìƒìœ ì €ë¥¼ 100ìœ¼ë¡œ í–ˆì„ ë•ŒëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œì™€ ê°€ìƒ ìŠ¤ë ˆë“œì˜ ì°¨ì´ê°€ ì—†ì—ˆë‹¤.</p>
<p>ì´ëŠ” ê¸°ë³¸ ìŠ¤ë ˆë“œ í’€ 200ê°œê°€ í™œì„±í™”ë˜ì–´ì„œ ë³„ ì°¨ì´ê°€ ì—†ëŠ” ê²ƒ ê°™ì•˜ë‹¤.<br><br></p>
<h2 id="500-ê°€ìƒ-ìœ ì €"><a href="#500-ê°€ìƒ-ìœ ì €" class="headerlink" title="500 ê°€ìƒ ìœ ì €"></a>500 ê°€ìƒ ìœ ì €</h2><p>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” ìµœëŒ€ ìŠ¤ë ˆë“œ í’€ì„ ìƒíšŒí•˜ëŠ” ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ ì§„ê°€ë¥¼ ë°œíœ˜í–ˆë‹¤.</p>
<p><strong>ê¸°ì¡´ ìŠ¤ë ˆë“œ</strong></p>
<p>TPS</p>
<img src="/2024/01/29/virtual-thread/non_vt_500threads.png" class="">

<p>ì‘ë‹µì‹œê°„</p>
<img src="/2024/01/29/virtual-thread/non_vt_500threads_rtt.png" class="">

<p>ê¸°ì¡´ ìŠ¤ë ˆë“œ ëª¨ë¸ì—ì„œëŠ” 650 ~ 700 TPSë¥¼ ë§´ëŒì•˜ê³  í‰ê·  ì‘ë‹µì‹œê°„ì€ 750msì˜€ë‹¤.</p>
<p><strong>ê°€ìƒ ìŠ¤ë ˆë“œ</strong></p>
<p>TPS</p>
<img src="/2024/01/29/virtual-thread/vt_500threads.png" class="">

<p>ì‘ë‹µì‹œê°„</p>
<img src="/2024/01/29/virtual-thread/vt_500threads_rtt.png" class="">

<p>ê°€ìƒ ìŠ¤ë ˆë“œë¡œ ì‹¤í–‰í•œ ì„œë²„ëŠ” 1400 ~ 1700 TPSë¥¼ ê¸°ë¡í–ˆê³  í‰ê·  ì‘ë‹µì‹œê°„ì€ ì´ˆë°˜ì„ ì œì™¸í•˜ë©´ 300 ~ 400ms ì •ë„ì˜€ë‹¤.<br><br></p>
<h2 id="1000-ê°€ìƒ-ìœ ì €"><a href="#1000-ê°€ìƒ-ìœ ì €" class="headerlink" title="1000 ê°€ìƒ ìœ ì €"></a>1000 ê°€ìƒ ìœ ì €</h2><p>ì´ë²ˆì—” í›¨ì”¬ ë” ë§ì€ ìœ ì €ë¥¼ ê°€ì •í•˜ê³  í…ŒìŠ¤íŠ¸í•´ë³´ì•˜ë‹¤.</p>
<p><strong>ê¸°ì¡´ ìŠ¤ë ˆë“œ</strong></p>
<p>TPS</p>
<img src="/2024/01/29/virtual-thread/non_vt_1000threads.png" class="">

<p>ì‘ë‹µì‹œê°„</p>
<img src="/2024/01/29/virtual-thread/non_vt_1000threads_rtt.png" class="">

<p>ê¸°ì¡´ ìŠ¤ë ˆë“œì˜ TPSëŠ” ê°€ìƒ ìœ ì €ê°€ 500ì¼ ë•Œì™€ ë³„ë‹¤ë¥´ì§€ ì•Šì•˜ê³  ì‘ë‹µì‹œê°„ì€ ê±°ì˜ 2ë°°ê°€ ë˜ì—ˆë‹¤.<br><br></p>
<p><strong>ê°€ìƒ ìŠ¤ë ˆë“œ</strong></p>
<p>TPS</p>
<img src="/2024/01/29/virtual-thread/vt_1000threads.png" class="">

<p>ì‘ë‹µì‹œê°„</p>
<img src="/2024/01/29/virtual-thread/vt_1000threads_rtt.png" class="">

<p>ê°€ìƒ ìŠ¤ë ˆë“œë¡œëŠ” 2400 ~ 3000 TPSë¥¼ ê¸°ë¡í–ˆê³  í‰ê·  ì‘ë‹µì‹œê°„ì€ 300 ~ 400msì˜€ë‹¤.<br><br></p>
<p>í™•ì‹¤íˆ ê¸°ì¡´ í”Œë«í¼ ìŠ¤ë ˆë“œë§Œì„ ì‚¬ìš©í–ˆì„ ë•Œë³´ë‹¤ ìœ ì˜ë¯¸í•˜ê²Œ ì„±ëŠ¥ì´ ê°œì„ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.<br><br></p>
<h1 id="ê°€ìƒ-ìŠ¤ë ˆë“œ-ì£¼ì˜ì‚¬í•­"><a href="#ê°€ìƒ-ìŠ¤ë ˆë“œ-ì£¼ì˜ì‚¬í•­" class="headerlink" title="ê°€ìƒ ìŠ¤ë ˆë“œ ì£¼ì˜ì‚¬í•­"></a>ê°€ìƒ ìŠ¤ë ˆë“œ ì£¼ì˜ì‚¬í•­</h1><p>ì´ë ‡ê²Œ ì¢‹ì•„ë³´ì´ê¸°ë§Œ í•˜ëŠ” ê°€ìƒ ìŠ¤ë ˆë“œì´ì§€ë§Œ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì˜¤íˆë ¤ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒë³´ë‹¤ë„ ëª»í•œ ê²½ìš°ê°€ ë  ìˆ˜ ìˆë‹¤.<br><br></p>
<ul>
<li><strong>í’€ë§í•˜ì§€ ë§ ê²ƒ</strong><ul>
<li>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” ìƒì„±í•˜ëŠ” ë¹„ìš©ì€ ì ì§€ë§Œ í•˜ë‚˜ì˜ ì‘ì—…ì„ ì‹¤í–‰í•˜ê³  GCì— ì˜í•´ ì œê±°ë˜ê²Œ ì„¤ê³„ë˜ì—ˆìœ¼ë¯€ë¡œ í’€ë§í•´ë†“ê³  ê³„ì† ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ë‚­ë¹„ê°€ ëœë‹¤.</li>
<li>í†°ìº£ì˜ ìŠ¤ë ˆë“œ í’€ ì„¤ì •ì„ í•´ì œí•˜ê³  <code>Executors.newVirtualThreadPerTaskExecutor()</code>ë¥¼ ì„¤ì •í•´ì¤€ë‹¤.</li>
<li>ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í–ˆë˜ ì½”ë“œëŠ” ì„¸ë§ˆí¬ì–´ë¥¼ ì‚¬ìš©í•˜ê²Œ ë³€ê²½í•´ì•¼ í•œë‹¤.</li>
</ul>
</li>
<li><strong>ìŠ¤ë ˆë“œë¡œì»¬(ThreadLocal) ì‚¬ìš©ì— ì£¼ì˜í•  ê²ƒ</strong><ul>
<li>ìŠ¤ë ˆë“œ ê°„ì— ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ í–ˆë˜ ìŠ¤ë ˆë“œë¡œì»¬(ThreadLocal)ì„ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  ê¸€ë¡œë²Œ ìºì‹± ì „ëµì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•œë‹¤.<ul>
<li>ì˜ˆë¥¼ ë“¤ë©´ ìŠ¤ë ˆë“œë¡œì»¬ì— DB ì»¤ë„¥ì…˜ì„ ì €ì¥í•´ë‘ê³  ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ìˆì—ˆë‹¤ë©´ ê°€ìƒ ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤.</li>
<li>ê¸°ì¡´ì˜ ìŠ¤ë ˆë“œ ë¡œì»¬ì„ ë³´ì™„í•˜ê¸° ìœ„í•œ <a target="_blank" rel="noopener" href="https://openjdk.org/jeps/446">Scoped Values</a> ì—­ì‹œ Project Loomì´ ì¤€ë¹„ ì¤‘ì¸ í•µì‹¬ ê¸°ëŠ¥ì´ë‹¤.</li>
</ul>
</li>
</ul>
</li>
<li><strong>CPU ì—°ì‚°ì´ í•„ìš”í•œ ì½”ë“œëŠ” ì‹¤í–‰í•˜ì§€ ë§ ê²ƒ</strong><ul>
<li>ê°€ìƒ ìŠ¤ë ˆë“œëŠ” non-blocking I&#x2F;O ì‘ì—… ì²˜ë¦¬ëŸ‰ì„ ëŠ˜ë¦¬ê¸° ìœ„í•´ ì„¤ê³„ëœ ìŠ¤ë ˆë“œë¡œì¨ CPU ì—°ì‚° ì„±ëŠ¥ì€ ê¸°ì¡´ í”Œë«í¼ ìŠ¤ë ˆë“œë³´ë‹¤ ë–¨ì–´ì§„ë‹¤.</li>
<li>ë°ì´í„°ë² ì´ìŠ¤ I&#x2F;O, ë„¤íŠ¸ì›Œí‚¹ ê°™ì€ ì‘ì—…ì„ ê°€ìƒ ìŠ¤ë ˆë“œì—ê²Œ ë§¡ê¸°ëŠ” ê²ƒì´ íš¨ìœ¨ì ì¼ ê²ƒì´ë‹¤.</li>
</ul>
</li>
<li><strong>synchronized ë˜ëŠ” native methodì„ í˜¸ì¶œí•˜ì§€ ë§ ê²ƒ</strong><ul>
<li>ê°€ìƒ ìŠ¤ë ˆë“œê°€ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ë§Œë‚˜ë©´ ìºë¦¬ì–´ ìŠ¤ë ˆë“œ(ì—°ê²°ëœ í”Œë«í¼ ìŠ¤ë ˆë“œ)ì— ê³ ì •(<strong>pinned</strong>)ë˜ì–´ blockí•˜ê³  ë§ˆìš´íŠ¸ë¥¼ í•´ì œí•  ìˆ˜ ì—†ê²Œ ëœë‹¤.</li>
<li>í”Œë«í¼ ìŠ¤ë ˆë“œë¡œ ì‹¤í–‰í•´ë„ ë§ˆì°¬ê°€ì§€ì´ì§€ë§Œ ê°€ìƒ ìŠ¤ë ˆë“œê°€ í”Œë«í¼ ìŠ¤ë ˆë“œì— pinned ë˜ë©´ í•´ë‹¹ OS ìŠ¤ë ˆë“œë„ block ìƒíƒœê°€ ëœë‹¤.</li>
<li>ìì£¼ ì‚¬ìš©ë˜ì§€ ì•Šê±°ë‚˜ ì¸ë©”ëª¨ë¦¬ ì‘ì—…ì„ ë³´í˜¸í•˜ëŠ” synchronized ê¹Œì§€ ì œê±°í•  í•„ìš”ëŠ” ì—†ë‹¤. í•˜ì§€ë§Œ ìì£¼ í˜¸ì¶œë˜ê³  ì˜¤ë«ë™ì•ˆ ê³ ì •ì‹œí‚¤ëŠ” ì½”ë“œ ë¸”ëŸ­ì€ <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html">ReentrantLock</a>ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•œë‹¤.</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/01/23/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-PCCP-%EA%B8%B0%EC%B6%9C%EB%AC%B8%EC%A0%9C-3%EB%B2%88-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%9C%EA%B3%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/23/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-PCCP-%EA%B8%B0%EC%B6%9C%EB%AC%B8%EC%A0%9C-3%EB%B2%88-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%9C%EA%B3%84/" class="post-title-link" itemprop="url">í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ PCCP ê¸°ì¶œë¬¸ì œ 3ë²ˆ - ì•„ë‚ ë¡œê·¸ ì‹œê³„ (JAVA)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-23 17:33:57" itemprop="dateCreated datePublished" datetime="2024-01-23T17:33:57+09:00">2024-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-31 18:03:30" itemprop="dateModified" datetime="2024-01-31T18:03:30+09:00">2024-01-31</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ë¬¸ì œ"><a href="#ë¬¸ì œ" class="headerlink" title="ë¬¸ì œ"></a>ë¬¸ì œ</h1><ul>
<li>ë§í¬<br><a target="_blank" rel="noopener" href="https://school.programmers.co.kr/learn/courses/30/lessons/250135">https://school.programmers.co.kr/learn/courses/30/lessons/250135</a></li>
</ul>
<p>ì‹œì¹¨, ë¶„ì¹¨, ì´ˆì¹¨ì´ ìˆëŠ” ì•„ë‚ ë¡œê·¸ì‹œê³„ê°€ ìˆìŠµë‹ˆë‹¤. ì‹œê³„ì˜ ì‹œì¹¨ì€ 12ì‹œê°„ë§ˆë‹¤, ë¶„ì¹¨ì€ 60ë¶„ë§ˆë‹¤, ì´ˆì¹¨ì€ 60ì´ˆë§ˆë‹¤ ì‹œê³„ë¥¼ í•œ ë°”í€´ ë•ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹œì¹¨, ë¶„ì¹¨, ì´ˆì¹¨ì´ ì›€ì§ì´ëŠ” ì†ë„ëŠ” ì¼ì •í•˜ë©° ê°ê° ë‹¤ë¦…ë‹ˆë‹¤. ì´ ì‹œê³„ì—ëŠ” ì´ˆì¹¨ì´ ì‹œì¹¨&#x2F;ë¶„ì¹¨ê³¼ ê²¹ì¹  ë•Œë§ˆë‹¤ ì•ŒëŒì´ ìš¸ë¦¬ëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ íŠ¹ì • ì‹œê°„ ë™ì•ˆ ì•ŒëŒì´ ìš¸ë¦° íšŸìˆ˜ë¥¼ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì€ 0ì‹œ 5ë¶„ 30ì´ˆë¶€í„° 0ì‹œ 7ë¶„ 0ì´ˆê¹Œì§€ ì•ŒëŒì´ ìš¸ë¦° íšŸìˆ˜ë¥¼ ì„¸ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.</p>
<img src="/2024/01/23/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-PCCP-%EA%B8%B0%EC%B6%9C%EB%AC%B8%EC%A0%9C-3%EB%B2%88-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%9C%EA%B3%84/image.png" class="">

<p>ê°€ì¥ ì§§ì€ ë°”ëŠ˜ì´ ì‹œì¹¨, ì¤‘ê°„ ê¸¸ì´ì¸ ë°”ëŠ˜ì´ ë¶„ì¹¨, ê°€ì¥ ê¸´ ë°”ëŠ˜ì´ ì´ˆì¹¨ì…ë‹ˆë‹¤.<br>ì•ŒëŒì´ ìš¸ë¦¬ëŠ” íšŸìˆ˜ë¥¼ ì„¸ê¸° ì‹œì‘í•œ ì‹œê°ì€ 0ì‹œ 5ë¶„ 30ì´ˆì…ë‹ˆë‹¤.<br>ì´í›„ 0ì‹œ 6ë¶„ 0ì´ˆê¹Œì§€ ì´ˆì¹¨ê³¼ ì‹œì¹¨&#x2F;ë¶„ì¹¨ì´ ê²¹ì¹˜ëŠ” ì¼ì€ ì—†ìŠµë‹ˆë‹¤.</p>
<img src="/2024/01/23/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-PCCP-%EA%B8%B0%EC%B6%9C%EB%AC%B8%EC%A0%9C-3%EB%B2%88-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%9C%EA%B3%84/image-1.png" class="">

<p>ì•½ 0ì‹œ 6ë¶„ 0.501ì´ˆì— ì´ˆì¹¨ê³¼ ì‹œì¹¨ì´ ê²¹ì¹©ë‹ˆë‹¤. ì´ë•Œ ì•ŒëŒì´ í•œ ë²ˆ ìš¸ë¦½ë‹ˆë‹¤.<br>ì´í›„ 0ì‹œ 6ë¶„ 6ì´ˆê¹Œì§€ ì´ˆì¹¨ê³¼ ì‹œì¹¨&#x2F;ë¶„ì¹¨ì´ ê²¹ì¹˜ëŠ” ì¼ì€ ì—†ìŠµë‹ˆë‹¤.</p>
<img src="/2024/01/23/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-PCCP-%EA%B8%B0%EC%B6%9C%EB%AC%B8%EC%A0%9C-3%EB%B2%88-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%9C%EA%B3%84/image-2.png" class="">

<p>ì•½ 0ì‹œ 6ë¶„ 6.102ì´ˆì— ì´ˆì¹¨ê³¼ ë¶„ì¹¨ì´ ê²¹ì¹©ë‹ˆë‹¤. ì´ë•Œ ì•ŒëŒì´ í•œ ë²ˆ ìš¸ë¦½ë‹ˆë‹¤.<br>ì´í›„ 0ì‹œ 7ë¶„ 0ì´ˆê¹Œì§€ ì´ˆì¹¨ê³¼ ì‹œì¹¨&#x2F;ë¶„ì¹¨ì´ ê²¹ì¹˜ëŠ” ì¼ì€ ì—†ìŠµë‹ˆë‹¤.<br>0ì‹œ 5ë¶„ 30ì´ˆë¶€í„° 0ì‹œ 7ë¶„ 0ì´ˆê¹Œì§€ëŠ” ì•ŒëŒì´ ë‘ ë²ˆ ìš¸ë¦½ë‹ˆë‹¤. ì´í›„ ì•½ 0ì‹œ 7ë¶„ 0.584ì´ˆì— ì´ˆì¹¨ê³¼ ì‹œì¹¨ì´ ê²¹ì³ì„œ ìš¸ë¦¬ëŠ” ì„¸ ë²ˆì§¸ ì•ŒëŒì€ íšŸìˆ˜ì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<br>

<h1 id="ì´ˆê¸°-ì ‘ê·¼-ë°©ë²•ê³¼-ì‹œí–‰ì°©ì˜¤"><a href="#ì´ˆê¸°-ì ‘ê·¼-ë°©ë²•ê³¼-ì‹œí–‰ì°©ì˜¤" class="headerlink" title="ì´ˆê¸° ì ‘ê·¼ ë°©ë²•ê³¼ ì‹œí–‰ì°©ì˜¤"></a>ì´ˆê¸° ì ‘ê·¼ ë°©ë²•ê³¼ ì‹œí–‰ì°©ì˜¤</h1><p>ì²˜ìŒì—ëŠ” ì´ˆê¸° ì‹œì¹¨, ë¶„ì¹¨, ì´ˆì¹¨ì˜ ê°ë„ë¥¼ ì„¤ì •í•˜ê³  ì´ˆë¥¼ 1ì´ˆì”© ì¦ê°€í•˜ë©´ì„œ ë³€ê²½ë˜ëŠ” ì´ˆì¹¨ì˜ ê°ë„ì™€ ë¶„ì¹¨ì˜ ê°ë„, ì‹œì¹¨ì˜ ê°ë„ë¥¼ ë¹„êµí•´ì„œ</p>
<p><code>í˜„ì¬ ì´ˆì¹¨ì˜ ê°ë„ â‰¤ í˜„ì¬ ë¶„ì¹¨ì˜ ê°ë„ â‰¤ 1ì´ˆ ë’¤ ë¶„ì¹¨ì˜ ê°ë„ â‰¤ 1ì´ˆ ë’¤ ì‹œì¹¨ì˜ ê°ë„</code></p>
<p>ë¥¼ ë§Œì¡±í•˜ë©´ ì¼€ì´ìŠ¤ë¥¼ í•˜ë‚˜ ì¦ê°€ì‹œí‚¤ëŠ” ë°©ë²•ìœ¼ë¡œ ì ‘ê·¼í–ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">solution</span><span class="params">(<span class="type">int</span> h1, <span class="type">int</span> m1, <span class="type">int</span> s1, <span class="type">int</span> h2, <span class="type">int</span> m2, <span class="type">int</span> s2)</span> &#123;</span><br><span class="line">    <span class="comment">// ì›ë˜ ê°ë„ì— 120ì„ ê³±í•˜ì</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">hourDegree</span> <span class="operator">=</span> h1 % <span class="number">12</span> * <span class="number">30</span> * <span class="number">120</span> + m1 * <span class="number">60</span> + s1;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">minDegree</span> <span class="operator">=</span> m1 * <span class="number">6</span> * <span class="number">120</span> + s1 * <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">secDegree</span> <span class="operator">=</span> s1 * <span class="number">6</span> * <span class="number">120</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">answer</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (secDegree &lt;= minDegree &amp;&amp; minDegree + <span class="number">12</span> &lt; secDegree + <span class="number">720</span>) &#123;</span><br><span class="line">            answer++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (secDegree &lt;= hourDegree &amp;&amp; hourDegree + <span class="number">1</span> &lt; secDegree + <span class="number">720</span>) &#123;</span><br><span class="line">            answer++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (secDegree == minDegree &amp;&amp; minDegree == hourDegree) &#123;</span><br><span class="line">            answer--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        s1++;</span><br><span class="line">        <span class="keyword">if</span> (s1 == <span class="number">60</span>) &#123;</span><br><span class="line">            s1 = <span class="number">0</span>;</span><br><span class="line">            m1++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (m1 == <span class="number">60</span>) &#123;</span><br><span class="line">            m1 = <span class="number">0</span>;</span><br><span class="line">            h1++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (h1 == h2 &amp;&amp; m1 == m2 &amp;&amp; s1 == s2)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        secDegree = s1 * <span class="number">6</span> * <span class="number">120</span>;</span><br><span class="line">        minDegree = m1 * <span class="number">6</span> * <span class="number">120</span> + s1 * <span class="number">12</span>;</span><br><span class="line">        hourDegree = h1 % <span class="number">12</span> * <span class="number">30</span> * <span class="number">120</span> + m1 * <span class="number">60</span> + s1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ì´ë ‡ê²Œ ì ‘ê·¼í–ˆë”ë‹ˆ 11ì‹œ 59ë¶„ 30ì´ˆë¶€í„° 12ì‹œ 0ë¶„ 0ì´ˆê¹Œì§€ ëŒì•„ê°ˆ ë•Œ ë‹µì´ ë§ì§€ ì•Šì•˜ë‹¤.</p>
<br>

<h1 id="ë¬¸ì œ-í•´ê²°"><a href="#ë¬¸ì œ-í•´ê²°" class="headerlink" title="ë¬¸ì œ í•´ê²°"></a>ë¬¸ì œ í•´ê²°</h1><p>ë„ì €íˆ í’€ê¸° ì–´ë ¤ìš´ ì™€ì¤‘ì— ìˆ˜í•™ì ì¸ ì ‘ê·¼ë²•ì„ ì œì‹œí•´ ë³¸ ì‚¬ëŒì´ ìˆì—ˆë‹¤.</p>
<h2 id="ì•Œê³ ë¦¬ì¦˜"><a href="#ì•Œê³ ë¦¬ì¦˜" class="headerlink" title="ì•Œê³ ë¦¬ì¦˜"></a>ì•Œê³ ë¦¬ì¦˜</h2><ol>
<li>0ì‹œ 0ë¶„ 0ì´ˆë¥¼ ê¸°ì¤€ìœ¼ë¡œ Hì‹œ Më¶„ Sì´ˆê¹Œì§€ì˜ ì´ ì‹œê°„ì„ ì´ˆ ë‹¨ìœ„ë¡œ êµ¬í•œë‹¤</li>
<li>í•´ë‹¹ ì‹œê°„ë™ì•ˆ ì´ˆì¹¨ì´ ì‹œì¹¨ê³¼ ë§Œë‚˜ëŠ” íšŸìˆ˜ë¥¼ êµ¬í•œë‹¤</li>
<li>í•´ë‹¹ ì‹œê°„ë™ì•ˆ ì´ˆì¹¨ì´ ë¶„ì¹¨ê³¼ ë§Œë‚˜ëŠ” íšŸìˆ˜ë¥¼ êµ¬í•œë‹¤</li>
<li>ìœ„ (2)ì™€ (3)ì„ ë”í•œë‹¤</li>
<li>ì‹œì¹¨, ë¶„ì¹¨, ì´ˆì¹¨ì´ ëª¨ë‘ ê²¹ì¹˜ëŠ” 0ì‹œ 0ë¶„ 0ì´ˆì™€ 12ì‹œ 0ë¶„ 0ì´ˆê°€ í¬í•¨ë˜ë©´ 1ì„ ëº€ë‹¤</li>
<li>(h2ì‹œ m2ë¶„ s2ì´ˆê¹Œì§€ íšŸìˆ˜) - (h1ì‹œ m1ë¶„ s1ì´ˆê¹Œì§€ íšŸìˆ˜) &#x3D; ìµœì¢… ì •ë‹µ</li>
</ol>
<br>

<h3 id="ì´ˆì¹¨ê³¼-ì‹œì¹¨-ë§Œë‚˜ëŠ”-íšŸìˆ˜-êµ¬í•˜ê¸°"><a href="#ì´ˆì¹¨ê³¼-ì‹œì¹¨-ë§Œë‚˜ëŠ”-íšŸìˆ˜-êµ¬í•˜ê¸°" class="headerlink" title="ì´ˆì¹¨ê³¼ ì‹œì¹¨ ë§Œë‚˜ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°"></a>ì´ˆì¹¨ê³¼ ì‹œì¹¨ ë§Œë‚˜ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°</h3><br>

<p>0ì‹œ 0ë¶„ 0ì´ˆì— ëª¨ë‘ ê²¹ì³ìˆëŠ” ìƒíƒœì—ì„œ ì¶œë°œí•œë‹¤ê³  ê°€ì •í•´ë³´ì.</p>
<p>ì´ˆì¹¨ì€ 1ì´ˆì— 6ë„ë¥¼ ëˆë‹¤.</p>
<p>ì‹œì¹¨ì€ 1ì‹œê°„ì— 30ë„ë¥¼ ëŒì•„ê°€ê³  1ì‹œê°„ì€ 3600ì´ˆì´ë¯€ë¡œ ì‹œì¹¨ì€ 1ì´ˆ ë™ì•ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn><mi mathvariant="normal">/</mi><mn>3600</mn></mrow><annotation encoding="application/x-tex">30 / 3600 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">/</span><span class="mord">3</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span></span>ë„ ì¦‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>120</mn></mfrac></mrow><annotation encoding="application/x-tex">1 \over 120</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ë„ ëŒì•„ê°„ë‹¤.</p>
<p>ì´ˆì¹¨ì´ 1ë°”í€´ë¥¼ ëŒì•„ ì œìë¦¬ë¡œ ì˜¨ ë’¤ì— ë‹¤ì‹œ ì›€ì§ì—¬ì„œ ì‹œì¹¨ê³¼ ë§Œë‚˜ëŠ” ì‹œê°„ì„ ì‹ìœ¼ë¡œ ì„¸ìš°ë©´</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>t</mi><mo>âˆ’</mo><mn>360</mn><mo>=</mo><mfrac><mn>1</mn><mn>120</mn></mfrac><mi>t</mi></mrow><annotation encoding="application/x-tex"> 
6t - 360 = {1 \over 120}t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord mathnormal">t</span></span></span></span> 

<p>ì—¬ê¸°ì„œ ì¢Œë³€ì€ tì´ˆ í›„ì˜ ì´ˆì¹¨ì˜ ê°ì´ê³  ìš°ë³€ì€ tì´ˆ í›„ì˜ ì‹œì¹¨ì˜ ê°ì´ë‹¤.</p>
<p>ì‹ì„ ì •ë¦¬í•˜ë©´,</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>719</mn><mi>t</mi><mo>=</mo><mn>43200</mn></mrow><annotation encoding="application/x-tex">719t = 43200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">1</span><span class="mord">9</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span></span></span></span>

<p>ì´ë¯€ë¡œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mn>43200</mn><mn>719</mn></mfrac></mrow><annotation encoding="application/x-tex">t = {43200 \over 719} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>ì´ˆ í›„ì— ì´ˆì¹¨ê³¼ ì‹œì¹¨ì´ ë§Œë‚œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<p>ì´ˆì¹¨ê³¼ ì‹œì¹¨ì´ ë§Œë‚œ í›„ì—ëŠ” ë‹¤ì‹œ ë‘˜ì´ ê²¹ì³ìˆëŠ” ìƒíƒœì´ë¯€ë¡œ ë˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>43200</mn><mn>719</mn></mfrac></mrow><annotation encoding="application/x-tex">43200 \over 719</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ì´ˆ í›„ì— ë§Œë‚˜ê²Œ ë˜ë¯€ë¡œ, ì´ˆì¹¨ê³¼ ì‹œì¹¨ì´ ë§Œë‚˜ëŠ” ì£¼ê¸°ëŠ” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>43200</mn><mn>719</mn></mfrac></mrow><annotation encoding="application/x-tex">{43200 \over 719}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>ì´ˆê°€ ëœë‹¤.</p>
<p>ê·¸ëŸ¬ë©´ tì´ˆ ë™ì•ˆ ë§Œë‚˜ëŠ” íšŸìˆ˜ëŠ” të¥¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>43200</mn><mn>719</mn></mfrac></mrow><annotation encoding="application/x-tex">43200 \over 719</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ë¡œ ë‚˜ëˆ„ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>
<h3 id="ì´ˆì¹¨ê³¼-ë¶„ì¹¨-ë§Œë‚˜ëŠ”-íšŸìˆ˜-êµ¬í•˜ê¸°"><a href="#ì´ˆì¹¨ê³¼-ë¶„ì¹¨-ë§Œë‚˜ëŠ”-íšŸìˆ˜-êµ¬í•˜ê¸°" class="headerlink" title="ì´ˆì¹¨ê³¼ ë¶„ì¹¨ ë§Œë‚˜ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°"></a>ì´ˆì¹¨ê³¼ ë¶„ì¹¨ ë§Œë‚˜ëŠ” íšŸìˆ˜ êµ¬í•˜ê¸°</h3><p>ë¶„ì¹¨ì€ 1ì´ˆì— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>10</mn></mfrac></mrow><annotation encoding="application/x-tex">1\over10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ë„ ì”© ì›€ì§ì¸ë‹¤.</p>
<p>ì‹œì¹¨ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì‹ì„ ì„¸ìš°ë©´</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>t</mi><mo>âˆ’</mo><mn>360</mn><mo>=</mo><mfrac><mn>1</mn><mn>10</mn></mfrac><mi>t</mi></mrow><annotation encoding="application/x-tex">6t - 360 = {1\over10}t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord mathnormal">t</span></span></span></span>

<p>ì´ë¯€ë¡œ ì •ë¦¬í•˜ë©´</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>59</mn><mi>t</mi><mo>=</mo><mn>3600</mn></mrow><annotation encoding="application/x-tex">59t = 3600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">9</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span></span>

<p>ì´ ë˜ì–´ì„œ ì´ˆì¹¨ê³¼ ë¶„ì¹¨ì€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>3600</mn><mn>59</mn></mfrac></mrow><annotation encoding="application/x-tex">3600\over59</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">9</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">6</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ì´ˆë§ˆë‹¤ í•œë²ˆ ì”© ë§Œë‚˜ê²Œ ë˜ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<br>

<h2 id="ì½”ë“œë¡œ-ì˜®ê¸°ê¸°"><a href="#ì½”ë“œë¡œ-ì˜®ê¸°ê¸°" class="headerlink" title="ì½”ë“œë¡œ ì˜®ê¸°ê¸°"></a>ì½”ë“œë¡œ ì˜®ê¸°ê¸°</h2><p>ì´ ì‹œê°„ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜ì™€ í•´ë‹¹ ì‹œê°„ë™ì•ˆ ë¶„ì¹¨, ì‹œì¹¨ê³¼ ë§Œë‚˜ëŠ” íšŸìˆ˜ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë”°ë¡œ ë¶„ë¦¬í•˜ì˜€ë‹¤.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * hì‹œ më¶„ sì´ˆ ê¹Œì§€ ì´ ì‹œê°„(ì´ˆ)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">totalSec</span><span class="params">(<span class="type">int</span> h, <span class="type">int</span> m, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3600</span> * h + <span class="number">60</span> * m + s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 0ì‹œ 0ë¶„ 0ì´ˆë¶€í„° hì‹œ më¶„ sì´ˆ ê¹Œì§€ì˜ ì•ŒëŒ íšŸìˆ˜</span></span><br><span class="line"><span class="comment"> * 0ì‹œ 0ë¶„ 0ì´ˆì— ìš¸ë¦¬ëŠ” ì•ŒëŒì€ ì œì™¸ë¨.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countAlarm</span><span class="params">(<span class="type">int</span> h, <span class="type">int</span> m, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">totalSec</span> <span class="operator">=</span> totalSec(h, m, s);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ì´ˆì¹¨ê³¼ ë¶„ì¹¨ì€ 3600/59ì´ˆë§ˆë‹¤ ë§Œë‚¨</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">minAlarm</span> <span class="operator">=</span> totalSec * <span class="number">59</span> / <span class="number">3600</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ì´ˆì¹¨ê³¼ ì‹œì¹¨ì€ 43200/719ì´ˆë§ˆë‹¤ ë§Œë‚¨</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">hourAlarm</span> <span class="operator">=</span> totalSec * <span class="number">719</span> / <span class="number">43200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 12ì‹œ 0ë¶„ 0ì´ˆ ì´ìƒì¸ ê²½ìš°ì—ëŠ” ì‹œì¹¨ ë¶„ì¹¨ ì´ˆì¹¨ì´ ê²¹ì¹˜ë¯€ë¡œ 1íšŒ ë¹¼ì•¼í•¨</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">exception</span> <span class="operator">=</span> totalSec &gt;= <span class="number">43200</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> minAlarm + hourAlarm - exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>ê·¸ë¦¬ê³  ë¬¸ì œì—ì„œ ì‹œì‘ ì‹œê°„ì´ 0ì‹œ 0ë¶„ 0ì´ˆì¼ ë•Œ 1íšŒ ì•ŒëŒì´ ìš¸ë¦°ë‹¤ê³  ì„¤ëª…ì´ ìˆìœ¼ë¯€ë¡œ</p>
<p>ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì„¸ì› ë˜ ì‹ì— ì¶”ê°€ì ìœ¼ë¡œ ì‘ì—…ì´ í•„ìš”í–ˆë‹¤.</p>
<h3 id="ìµœì¢…-ì½”ë“œ"><a href="#ìµœì¢…-ì½”ë“œ" class="headerlink" title="ìµœì¢… ì½”ë“œ"></a>ìµœì¢… ì½”ë“œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">solution</span><span class="params">(<span class="type">int</span> h1, <span class="type">int</span> m1, <span class="type">int</span> s1, <span class="type">int</span> h2, <span class="type">int</span> m2, <span class="type">int</span> s2)</span> &#123;</span><br><span class="line">        <span class="comment">// ì‹œì‘ ì‹œê°„ì´ 0ì‹œ 0ë¶„ 0ì´ˆì´ê±°ë‚˜ 12ì‹œ 0ë¶„ 0ì´ˆì¸ ê²½ìš° ì‹œì‘í•˜ìë§ˆì 1íšŒ ìš¸ë¦¬ë¯€ë¡œ ì˜ˆì™¸ ì²˜ë¦¬</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">exception</span> <span class="operator">=</span> (h1 % <span class="number">12</span> == <span class="number">0</span> &amp;&amp; m1 == s1 &amp;&amp; s1 == <span class="number">0</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> countAlarm(h2, m2, s2) - countAlarm(h1, m1, s1) + exception;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hì‹œ më¶„ sì´ˆ ê¹Œì§€ ì´ ì‹œê°„(ì´ˆ)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">totalSec</span><span class="params">(<span class="type">int</span> h, <span class="type">int</span> m, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3600</span> * h + <span class="number">60</span> * m + s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 0ì‹œ 0ë¶„ 0ì´ˆë¶€í„° hì‹œ më¶„ sì´ˆ ê¹Œì§€ì˜ ì•ŒëŒ íšŸìˆ˜</span></span><br><span class="line"><span class="comment">     * 0ì‹œ 0ë¶„ 0ì´ˆì— ìš¸ë¦¬ëŠ” ì•ŒëŒì€ ì œì™¸ë¨.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">countAlarm</span><span class="params">(<span class="type">int</span> h, <span class="type">int</span> m, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">totalSec</span> <span class="operator">=</span> totalSec(h, m, s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ì´ˆì¹¨ê³¼ ë¶„ì¹¨ì€ 3600/59ì´ˆë§ˆë‹¤ ë§Œë‚¨</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">minAlarm</span> <span class="operator">=</span> totalSec * <span class="number">59</span> / <span class="number">3600</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ì´ˆì¹¨ê³¼ ì‹œì¹¨ì€ 43200/719ì´ˆë§ˆë‹¤ ë§Œë‚¨</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">hourAlarm</span> <span class="operator">=</span> totalSec * <span class="number">719</span> / <span class="number">43200</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 12ì‹œ 0ë¶„ 0ì´ˆ ì´ìƒì¸ ê²½ìš°ì—ëŠ” ì‹œì¹¨ ë¶„ì¹¨ ì´ˆì¹¨ì´ ê²¹ì¹˜ë¯€ë¡œ 1íšŒ ë¹¼ì•¼í•¨</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">exception</span> <span class="operator">=</span> totalSec &gt;= <span class="number">43200</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> minAlarm + hourAlarm - exception;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ëŠë‚€ì "><a href="#ëŠë‚€ì " class="headerlink" title="ëŠë‚€ì "></a>ëŠë‚€ì </h1><p>ì‚¬ì‹¤ ìˆ˜í•™ì ì¸ í’€ì´ëŠ” ë‹¤ë¥¸ ì‚¬ëŒì˜ í’€ì´ë¥¼ ì•½ê°„ ì°¸ê³ í•˜ì˜€ëŠ”ë°</p>
<p>ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í’€ì´ë¥¼ í•  ë•ŒëŠ” ì—­ì‹œ í”„ë¡œê·¸ë˜ë°ì  êµ¬í˜„ë„ ì¤‘ìš”í•˜ì§€ë§Œ ìˆ˜í•™ì ì¸ ì ‘ê·¼ ë°©ë²•ì„ ë¨¼ì € ìƒê°í•´ë³´ëŠ” ê²ƒì´ ì¢‹ì€ ê²ƒ ê°™ë‹¤.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/01/22/ElasticSearch-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/22/ElasticSearch-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94/" class="post-title-link" itemprop="url">ElasticSearch ì„±ëŠ¥ ìµœì í™”</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-22 16:51:38" itemprop="dateCreated datePublished" datetime="2024-01-22T16:51:38+09:00">2024-01-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-31 18:03:30" itemprop="dateModified" datetime="2024-01-31T18:03:30+09:00">2024-01-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Elastic-Stack/" itemprop="url" rel="index"><span itemprop="name">Elastic Stack</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Heap-Size"><a href="#Heap-Size" class="headerlink" title="Heap Size"></a>Heap Size</h1><p>ì¼ë°˜ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì˜ 50%ë¥¼ í™ìœ¼ë¡œ í• ë‹¹í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•˜ì§€ë§Œ í™ ì‚¬ì´ì¦ˆê°€ 32G ì´ìƒìœ¼ë¡œ ì»¤ì§ˆ ê²½ìš° ë‹¨ì ì´ ìˆë‹¤.</p>
<p>í™ ì‚¬ì´ì¦ˆê°€ í¬ë‹¤ê³  ë¬´ì¡°ê±´ ì„±ëŠ¥ì´ ì¢‹ì•„ì§€ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. ì˜¤íˆë ¤ <strong>32G ì´ìƒì˜ í™ ì‚¬ì´ì¦ˆëŠ” ì„±ëŠ¥ì„ ì €í•˜ì‹œí‚¨ë‹¤</strong>ê³  í•œë‹¤.</p>
<p>ì´ê±´ ë¹„ë‹¨ ES ë¿ë§Œ ì•„ë‹ˆë¼ JVMì„ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì•±ì´ë¼ë©´ ê³µí†µìœ¼ë¡œ ì ìš©ë˜ëŠ” ì ì´ë‹¤.</p>
<h2 id="ì´ìœ "><a href="#ì´ìœ " class="headerlink" title="ì´ìœ "></a>ì´ìœ </h2><p>JVMì€ OOPS(Ordinary Object Pointers) ë¼ëŠ” ê²ƒìœ¼ë¡œ ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œë¥¼ ê´€ë¦¬í•œë‹¤. Cì˜ í¬ì¸í„°ë‘ ë¹„ìŠ·í•œ ê°œë…ì´ë‹¤.</p>
<p>ì˜ˆì „ 32bit OSì˜ ê²½ìš° ë©”ëª¨ë¦¬ê°€ 4Gì´ë¯€ë¡œ ë©”ëª¨ë¦¬ ì£¼ì†Œ ì°¾ëŠ” ê²Œ ê·¸ë ‡ê²Œ ì˜¤ë˜ ê±¸ë¦¬ì§€ ì•Šì•˜ë‹¤.</p>
<p>í•˜ì§€ë§Œ 64bitì¸ ê²½ìš° ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì°¾ëŠ”ë° ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¬ë¯€ë¡œ JVMì€ Compressed OOPSë¼ëŠ” ê¸°ë²•ì„ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê´€ë¦¬í•˜ê¸°ë¡œ í•œë‹¤.</p>
<p>ì›ë¦¬ëŠ” 32bit ì£¼ì†Œì— offset bitë¥¼ 3ë¹„íŠ¸ ì¶”ê°€í•˜ì—¬ 32bit * 8 ê°œì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŒ€ëµ 32GBì˜ ì£¼ì†Œê°’ê¹Œì§€ í‘œí˜„í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>
<p>í•˜ì§€ë§Œ í™ ì‚¬ì´ì¦ˆê°€ 32Gë³´ë‹¤ ì»¤ì§ˆ ê²½ìš° ì´ Compressed OOPS ë°©ì‹ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ê·¸ëƒ¥ OOPSë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì°¾ëŠ”ë° ë§¤ìš° ì˜¤ë˜ ê±¸ë¦¬ê²Œ ëœë‹¤.</p>
<p>Compressed OOPS ë°©ì‹ì˜ 35bit ì£¼ì†Œì—ì„œ offset 3bitë¥¼ ë²„ë¦¬ê¸° ìœ„í•´ shift left 3 ( &lt;&lt; 3 ) ì—°ì‚°ì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ë•Œ ë©”ëª¨ë¦¬ ì£¼ì†Œì˜ ì‹œì‘ì ì´ 0ì´ ì•„ë‹ˆë¼ë©´ ì—¬ê¸°ì— ë©”ëª¨ë¦¬ ì‹œì‘ ì£¼ì†Œë¥¼ ë”í•´ì•¼ í•˜ëŠ” ì—°ì‚°ì´ ì¶”ê°€ë¡œ ë“¤ì–´ê°„ë‹¤. (Non-zero based)</p>
<p>í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ ì£¼ì†Œì˜ ì‹œì‘ì ì´ 0ì´ë¼ë©´ shift left 3 (&lt;&lt; 3)ë§Œ í•´ë„ ì›ë˜ ì£¼ì†Œë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆë‹¤. (Zero based)</p>
<p>ì´ëŠ” JVMìœ¼ë¡œ oops ë°©ì‹ì„ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´ë¡œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.<br><br></p>
<ul>
<li>ë©”ëª¨ë¦¬ê°€ 64Gì¸ ì‹œìŠ¤í…œì—ì„œ í™ì„ 31Gë¡œ ì¤€ë‹¤ë©´?<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Xmx31G -XX:+UnlockDiagnosticVMOptions -Xlog:gc+heap+coops=debug -version</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Heap address: 0x0000001000800000, size: 31744 MB, Compressed Oops mode: Non-zero disjoint base: 0x0000001000000000, Oop <span class="built_in">shift</span> amount: 3</span><br></pre></td></tr></table></figure></li>
</ul>
<p>ì´ëŸ° ì‹ìœ¼ë¡œ base ì£¼ì†Œê°€ 0ì´ ì•„ë‹˜ì„ í™•ì¸í•  ìˆ˜ ìˆê³  Non-zero baseë¼ê³  í‘œì‹œëœë‹¤.<br><br></p>
<ul>
<li>ì´ë²ˆì—” í™ì„ 30Gë¡œ ì¤€ë‹¤ë©´<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Xmx30G -XX:+UnlockDiagnosticVMOptions -Xlog:gc+heap+coops=debug -version</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Heap address: 0x0000000080000000, size: 30720 MB, Compressed Oops mode: Zero based, Oop <span class="built_in">shift</span> amount: 3</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Zero based ëª¨ë“œë¼ê³  í‘œì‹œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  ESëŠ” OSì˜ ë‚˜ë¨¸ì§€ ì—¬ìœ  ë©”ëª¨ë¦¬ë¥¼ íŒŒì¼ì‹œìŠ¤í…œ ìºì‹œë¡œ ì´ìš©í•˜ê¸° ë•Œë¬¸ì— ì´ ìºì‹œì˜ í¬ê¸°ë¥¼ ë” ëŠ˜ë¦¬ëŠ” ê²ƒì´ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.<br><br><br><strong>ì¦‰, OSì˜ ë©”ëª¨ë¦¬ ì ˆë°˜ì„ í™ ì‚¬ì´ì¦ˆë¡œ í• ë‹¹í•˜ë©´ ë‚˜ë¨¸ì§€ ì ˆë°˜ì€ ESê°€ ìºì‹œë¡œ ì‚¬ìš©í•œë‹¤ëŠ” ì–˜ê¸°.</strong></p>
<p>ë˜ ë‹¤ë¥¸ ì´ìœ ë¡œëŠ” í™ ì‚¬ì´ì¦ˆê°€ í´ ê²½ìš° gcê°€ ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ëŠ” ì•±ì—ì„œëŠ” í™ì— ë¹„ë¡€í•˜ì—¬ cpu ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•˜ê³  stop the world ì‹œê°„ì´ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ë„ˆë¬´ í° í™ ì‚¬ì´ì¦ˆëŠ” ì¢‹ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</p>
<p>ì´ê±´ JVM ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê³µí†µ ì‚¬í•­ì´ë‹¤.</p>
<br>

<h1 id="Mapping"><a href="#Mapping" class="headerlink" title="Mapping"></a>Mapping</h1><p>ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•˜ê¸° ì „ì— ì¸ë±ìŠ¤ í…œí”Œë¦¿ì„ ìƒì„±í•˜ê³  ë§¤í•‘ì„ ì ì ˆíˆ í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p>
<p>íŠ¹íˆ string í•„ë“œëŠ” ESì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ textì™€ keyword íƒ€ì…ì„ ë‘˜ë‹¤ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ìš©ëŸ‰ì„ ë‚­ë¹„í•˜ê³  ê²€ìƒ‰ ì„±ëŠ¥ì´ ì €í•˜ëœë‹¤.</p>
<p>ë”°ë¼ì„œ í…ìŠ¤íŠ¸ ë¶„ì„ì´ í•„ìš”í•˜ê³  ê²€ìƒ‰ ê¸°ëŠ¥ì´ í•„ìš”í•œ í•„ë“œëŠ” textë§Œ ë§¤í•‘í•˜ê³  ë‚˜ë¨¸ì§€ í•„í„°ë§ì„ ìœ„í•œ í•„ë“œëŠ” keywordë¡œ ë§¤í•‘í•˜ì—¬ ë¶ˆí•„ìš”í•œ ì—°ì‚°ì´ë‚˜ ìš©ëŸ‰ì„ ì œê±°í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p>
<p><em><strong>í•˜ì§€ë§Œ ë°˜ëŒ€ë¡œ Mappingì— ëŒ€í•´ ìì„¸íˆ ì´í•´í•˜ì§€ ëª»í•˜ê³  íšì¼í™”ëœ Mappingë§Œ ì‚¬ìš©í•œë‹¤ë©´ NoSQLì˜ ì¥ì ì„ í™œìš©í•˜ì§€ ëª»í•˜ê²Œ ëœë‹¤.</strong></em></p>
<p>ì¸ë±ìŠ¤ì˜ Mappingì„ ë³€ê²½í•˜ëŠ” ì‘ì—…ì€ ê·¸ë ‡ê²Œ ì–´ë ¤ìš´ ì¼ì´ ì•„ë‹ˆë¯€ë¡œ ì¡°ê¸ˆì”© ê³µë¶€í•˜ë©´ì„œ ë³€ê²½í•˜ëŠ” ê²ƒë„ ì¢‹ë‹¤.</p>
<br>

<h1 id="Shard"><a href="#Shard" class="headerlink" title="Shard"></a>Shard</h1><p>ìƒ¤ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì¸ë±ìŠ¤ 1ê°œì™€ ë§¤í•‘ë˜ì–´ ìˆê³  ìƒ¤ë“œì˜ ê°¯ìˆ˜ëŠ” ì¸ë±ìŠ¤ 1ê°œë‹¹ 1ê°œ ì´ìƒì´ë‹¤. (1ëŒ€ë‹¤ ê´€ê³„)</p>
<p>ë…¸ë“œê°€ ì—¬ëŸ¬ ê°œì¸ ê²½ìš° ìƒ¤ë“œë¥¼ ë¶„ì‚°ë°°ì¹˜í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„°ë§, ë¡œë“œ ë°¸ëŸ°ì‹± ë“±ì´ ê°€ëŠ¥í•´ì§„ë‹¤.</p>
<h2 id="ìƒ¤ë“œì˜-ê°¯ìˆ˜"><a href="#ìƒ¤ë“œì˜-ê°¯ìˆ˜" class="headerlink" title="ìƒ¤ë“œì˜ ê°¯ìˆ˜"></a>ìƒ¤ë“œì˜ ê°¯ìˆ˜</h2><p>ESì—ì„œëŠ” ë…¸ë“œ 1ê°œë‹¹ ìƒ¤ë“œì˜ ê°¯ìˆ˜ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì¢‹ì§€ ì•Šë‹¤ê³  í•œë‹¤.</p>
<p><strong>ìƒ¤ë“œì˜ ê°¯ìˆ˜ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ë§ˆìŠ¤í„° ë…¸ë“œê°€ ìƒ¤ë“œë¥¼ ì¶”ì í•  ë•Œ ì—°ì‚°ëŸ‰ì´ ë§ì•„ì ¸ ì„±ëŠ¥ì´ ì €í•˜ëœë‹¤.</strong></p>
<p><strong>ì¼ë°˜ì ìœ¼ë¡œ Heap ì‚¬ì´ì¦ˆ 1GB ë‹¹ 20ê°œ ë¯¸ë§Œ</strong> (ì˜ˆ. Heap 8GB -&gt; ìƒ¤ë“œ 160ê°œ) ìœ¼ë¡œ í•˜ëŠ” ê²ƒì´ ì¢‹ì§€ë§Œ ì´ë³´ë‹¤ ë” ì ê²Œ í•  ê²ƒì„ ê¶Œì¥í•œë‹¤ê³  í•œë‹¤.</p>
<h2 id="ìƒ¤ë“œì˜-ìš©ëŸ‰"><a href="#ìƒ¤ë“œì˜-ìš©ëŸ‰" class="headerlink" title="ìƒ¤ë“œì˜ ìš©ëŸ‰"></a>ìƒ¤ë“œì˜ ìš©ëŸ‰</h2><p><strong>ìƒ¤ë“œ 1ê°œì˜ ìš©ëŸ‰ì€ ì•½ 20GB~40GB ì •ë„ë¡œ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤</strong>ê³  í•œë‹¤.</p>
<p>ìƒ¤ë“œì—ëŠ” Lucene ì—”ì§„ ì¸ìŠ¤í„´ìŠ¤ë¡œì„œ ì •ë³´ë¥¼ ë³´ê´€í•˜ê³  ìˆëŠ” ì„¸ê·¸ë¨¼íŠ¸ê°€ ìˆë‹¤.</p>
<p>ì„¸ê·¸ë¨¼íŠ¸ëŠ” ë°ì´í„°ê°€ ë§ì„ìˆ˜ë¡ ì»¤ì§€ê¸°ëŠ” í•˜ëŠ”ë° ì¤‘ìš”í•œ ì ì€ <strong>ë°ì´í„°ê°€ ì ì„ ë•Œì˜ ì„¸ê·¸ë¨¼íŠ¸ì™€ ë°ì´í„°ê°€ ë§ì„ ë•Œ ì„¸ê·¸ë¨¼íŠ¸ í¬ê¸°ëŠ” ë³„ë¡œ ì°¨ì´ë‚˜ì§€ ì•ŠëŠ” ê²ƒ</strong>ì´ë‹¤.</p>
<p>ì´ ë§ì€, ìƒ¤ë“œì— ì ì¬ëœ ë°ì´í„°ê°€ ì ì„ ë•Œ 1GB ë‹¹ ì˜¤ë²„í—¤ë“œê°€ ë°ì´í„°ê°€ ë§ì„ ë•Œ 1GB ë‹¹ ì˜¤ë²„í—¤ë“œë³´ë‹¤ ì›”ë“±íˆ í¬ë‹¤ëŠ” ê²ƒì„ ë§í•œë‹¤.</p>
<p>ì´ ë•Œë¬¸ì— 50MB ìš©ëŸ‰ì˜ ìƒ¤ë“œ 1000ê°œì—ì„œ ì¿¼ë¦¬í•˜ëŠ” ê²ƒë³´ë‹¤ 50GBì˜ ìƒ¤ë“œ 1ê°œì—ì„œ ì¿¼ë¦¬í•˜ëŠ” ê²ƒì´ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° í›¨ì”¬ ë” ë¹ ë¥´ë‹¤.</p>
<p>50MBì˜ ìƒ¤ë“œì™€ 50GB ìƒ¤ë“œì˜ ì„¸ê·¸ë¨¼íŠ¸ í¬ê¸°ëŠ” ë³„ ì°¨ì´ê°€ ì—†ëŠ”ë°, ì „ìëŠ” 1000ê°œì˜ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ í•©ì¹˜ëŠ” ê³¼ì •ì—ì„œ ì—„ì²­ë‚œ ë¦¬ì†ŒìŠ¤ë¥¼ í•„ìš”ë¡œ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>
<p>ê·¸ë˜ì„œ ì´ë¯¸ ìƒ¤ë“œì˜ ê°¯ìˆ˜ê°€ ë§ì•„ì¡Œì„ ê²½ìš° <strong>ê°•ì œ ë³‘í•©</strong> ê³¼ì •ì„ í†µí•´ì„œ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë³‘í•©í•´ ì˜¤ë²„í—¤ë“œë¥¼ ì¤„ì—¬ ì„±ëŠ¥ì„ ê°œì„ í•  ìˆ˜ ìˆë‹¤.</p>
<p>í•˜ì§€ë§Œ ë˜í•œ, 50GB ì´ìƒìœ¼ë¡œ ë„ˆë¬´ í¬ê²Œ í•˜ì§€ ì•Šì„ ê²ƒì„ ê¶Œì¥í•˜ê³  ìˆë‹¤.</p>
<br>

<h2 id="ElasticSearch-8-3-ëŠ”-ë‹¤ë¥´ë‹¤"><a href="#ElasticSearch-8-3-ëŠ”-ë‹¤ë¥´ë‹¤" class="headerlink" title="ElasticSearch &gt;&#x3D; 8.3 ëŠ” ë‹¤ë¥´ë‹¤!"></a>ElasticSearch &gt;&#x3D; 8.3 ëŠ” ë‹¤ë¥´ë‹¤!</h2><p>í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•œ ë‚ ì§œê°€ 2022ë…„ì´ê³  ë‹¹ì‹œì— ES 7.10 ë²„ì „ì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í–ˆì—ˆëŠ”ë°, ìµœê·¼ ES ë¬¸ì„œë¥¼ í™•ì¸í•´ë³´ë‹ˆê¹Œ 8.3 ë²„ì „ ì´ìƒë¶€í„°ëŠ” **ìƒ¤ë“œì˜ ê°¯ìˆ˜ ê·œì¹™ (í™ 1GB ë‹¹ 20ê°œ ë¯¸ë§Œ)**ì´ ë‹¤ë¥´ë‹¤ê³  í•œë‹¤!</p>
<h3 id="ìƒˆë¡œìš´-íŒ"><a href="#ìƒˆë¡œìš´-íŒ" class="headerlink" title="ìƒˆë¡œìš´ íŒ"></a>ìƒˆë¡œìš´ íŒ</h3><p>8.3 ë²„ì „ ì´ìƒì—ì„œ ESì˜ ê²½í—˜ ë²•ì¹™ì— ë”°ë¥´ë©´ <strong>ê° ë°ì´í„° ë…¸ë“œì˜ ì¸ë±ìŠ¤ ë‹¹ ë§¤í•‘ëœ í•„ë“œ ìˆ˜ X 1kB + 0.5GB</strong> ë¥¼ ê¶Œì¥í•œë‹¤ê³  í•œë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ì„œ, ë°ì´í„° ë…¸ë“œê°€ 1000ê°œì˜ ì¸ë±ìŠ¤ ìƒ¤ë“œë¥¼ ë³´ìœ í•˜ê³  ìˆê³ , ê° ì¸ë±ìŠ¤ê°€ 4000ê°œì˜ í•„ë“œê°€ ë§¤í•‘ë˜ì–´ ìˆë‹¤ë©´</p>
<p><strong>1000 x 4000 x 1kB &#x3D; 4GB</strong>ì— <strong>ì¶”ê°€ë¡œ 0.5GB</strong>ë¥¼ í• ë‹¹í•´ <strong>4.5GB ì´ìƒ</strong>ì˜ í™ í¬ê¸°ë¥¼ í• ë‹¹í•´ì¤„ ê²ƒì„ ê¶Œì¥í•˜ê³  ìˆë‹¤.</p>
<p>ë˜, ìƒ¤ë“œ ë‹¹ ë°ì´í„°ì˜ í¬ê¸°ëŠ” 10GB~50GBë¥¼ ê¶Œì¥í•˜ê³  ìˆë‹¤.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/01/05/%ED%8E%98%EC%9D%B4%EC%A7%95-%EC%BF%BC%EB%A6%AC-%ED%8C%8C%ED%97%A4%EC%B3%90-%EB%B3%B4%EA%B8%B0-1-Row-count%EA%B9%8C%EC%A7%80-%EA%B0%99%EC%9D%B4-%EC%A1%B0%ED%9A%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/05/%ED%8E%98%EC%9D%B4%EC%A7%95-%EC%BF%BC%EB%A6%AC-%ED%8C%8C%ED%97%A4%EC%B3%90-%EB%B3%B4%EA%B8%B0-1-Row-count%EA%B9%8C%EC%A7%80-%EA%B0%99%EC%9D%B4-%EC%A1%B0%ED%9A%8C/" class="post-title-link" itemprop="url">í˜ì´ì§• ì¿¼ë¦¬ íŒŒí—¤ì³ ë³´ê¸° - 1. Row countê¹Œì§€ ê°™ì´ ì¡°íšŒ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-05 12:50:44" itemprop="dateCreated datePublished" datetime="2024-01-05T12:50:44+09:00">2024-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-11 18:31:59" itemprop="dateModified" datetime="2024-01-11T18:31:59+09:00">2024-01-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SQL/" itemprop="url" rel="index"><span itemprop="name">SQL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="í˜ì´ì§•-ì¿¼ë¦¬-íŒŒí—¤ì³-ë³´ê¸°-1-Row-countê¹Œì§€-ê°™ì´-ì¡°íšŒ"><a href="#í˜ì´ì§•-ì¿¼ë¦¬-íŒŒí—¤ì³-ë³´ê¸°-1-Row-countê¹Œì§€-ê°™ì´-ì¡°íšŒ" class="headerlink" title="í˜ì´ì§• ì¿¼ë¦¬ íŒŒí—¤ì³ ë³´ê¸° - 1. Row countê¹Œì§€ ê°™ì´ ì¡°íšŒ"></a>í˜ì´ì§• ì¿¼ë¦¬ íŒŒí—¤ì³ ë³´ê¸° - 1. Row countê¹Œì§€ ê°™ì´ ì¡°íšŒ</h1><p>ì‚¬ë‚´ ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ê°œë°œí•˜ë©´ì„œ í˜ì´ì§• ì²˜ë¦¬í•  ë°ì´í„°ì™€ í˜ì´ì§• Row countë¥¼ í•œ ë²ˆì— ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ê³ ë¯¼í–ˆë˜ ë‚´ìš©ì„ ì •ë¦¬í•´ë³¸ë‹¤</p>
<h2 id="OVER-ì‚¬ìš©"><a href="#OVER-ì‚¬ìš©" class="headerlink" title="OVER () ì‚¬ìš©"></a>OVER () ì‚¬ìš©</h2><p>StackOverflowì— ì´ ë‚´ìš©ìœ¼ë¡œ ë¬¼ì–´ë³´ë©´ ê°€ì¥ ì²˜ìŒ ë‚˜ì˜¤ëŠ” ê²°ê³¼ê°€ OVER () ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line">      , total_count <span class="operator">=</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">OVER</span>()</span><br><span class="line"><span class="comment">-- ë˜ëŠ”, COUNT(*) OVER() AS total_count</span></span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> ...</span><br><span class="line"><span class="keyword">OFFSET</span> <span class="number">120</span> <span class="keyword">ROWS</span></span><br><span class="line"><span class="keyword">FETCH</span> NEXT <span class="number">10</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span>;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://facewise.github.io/2024/01/02/2024-01-02-initial-log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yonghyun Kim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="facewiseLog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | facewiseLog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/02/2024-01-02-initial-log/" class="post-title-link" itemprop="url">Initial log</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-02 23:00:00" itemprop="dateCreated datePublished" datetime="2024-01-02T23:00:00+09:00">2024-01-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-03 18:25:34" itemprop="dateModified" datetime="2024-01-03T18:25:34+09:00">2024-01-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/note/" itemprop="url" rel="index"><span itemprop="name">note</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Initial-logâ€¦"><a href="#Initial-logâ€¦" class="headerlink" title="Initial logâ€¦"></a>Initial logâ€¦</h1><ul>
<li>ì§€ê¸ˆê¹Œì§€ì˜ ë‚˜ëŠ”<ul>
<li>ë¬´ê³„íš</li>
<li>ì¦‰í¥ì </li>
<li>ë¨¸ë¦¬ë¡œ, ì†ìœ¼ë¡œ ê¸°ì–µí•˜ê³  ìˆìœ¼ë©´ ëœ ê²ƒ</li>
</ul>
</li>
<li>ì•ìœ¼ë¡œì˜ ë‚˜ëŠ”<ul>
<li>ê¾¸ì¤€í•˜ê²Œ</li>
<li>ê¸°ë¡í•˜ê³ </li>
<li>ë‹¨ê¸° ëª©í‘œë¥¼ ì„¸ìš°ê³ </li>
<li>ë„ë¦¬ í¼ëœ¨ë¦¬ëŠ”</li>
</ul>
</li>
</ul>
<p>2024ë…„, ë‹¬ë¼ì§€ê¸° ìœ„í•´ ì²« ë¡œê·¸ë¥¼ ì ëŠ”ë‹¤</p>
<p>â€˜ë‚˜ ì•ˆë‚´ì„œâ€™ë¥¼ ì‘ì„±í•˜ê³ <br>â€˜ëŠë‚€ ì â€™ì„ ê¸°ë¡í•˜ì<br>ëˆ„êµ¬ì—ê²Œ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ê²ƒì´ ì•„ë‹Œ ë‚˜ë¥¼ ìœ„í•´ì„œ</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Yonghyun Kim</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/facewise" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
